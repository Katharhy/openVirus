<?xml version="1.0" encoding="UTF-8"?>
<fig id="pcbi.1008122.g002" orientation="portrait" position="float">
 <object-id pub-id-type="doi">10.1371/journal.pcbi.1008122.g002</object-id>
 <label>Fig 2</label>
 <caption>
  <title>Schematic representation of the coordinate-ascent algorithm.</title>
  <p>(a) The branches in the genealogy 
   <inline-formula id="pcbi.1008122.e045">
    <alternatives>
     <graphic id="pcbi.1008122.e045g" xlink:href="pcbi.1008122.e045" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     <math id="M45">
      <mi mathvariant="script">G</mi>
     </math>
    </alternatives>
   </inline-formula> have been divided into 4 slices (labeled as ⓪ to ③). (b) The algorithm performs estimation of model parameters (denoted as Θ) and reconstructing the transmission history 
   <inline-formula id="pcbi.1008122.e046">
    <alternatives>
     <graphic id="pcbi.1008122.e046g" xlink:href="pcbi.1008122.e046" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     <math id="M46">
      <mi mathvariant="script">H</mi>
     </math>
    </alternatives>
   </inline-formula> (or labeling the branches (with different letters) of a genealogy) simultaneously under the likelihood framework. The algorithm starts from the external branches (labeled as ⓪) which come from different individuals, and proceeds backwards slice by slice. The internal branches with the same label represent the infectious period of a particular individual, who is the infector of the transmission events during that period. (c) Given the present estimate of model parameters and transmission history (
   <inline-formula id="pcbi.1008122.e047">
    <alternatives>
     <graphic id="pcbi.1008122.e047g" xlink:href="pcbi.1008122.e047" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     <math id="M47">
      <msup>
       <mover accent="true">
        <mi>Θ</mi>
        <mo>^</mo>
       </mover>
       <mn>1</mn>
      </msup>
     </math>
    </alternatives>
   </inline-formula>,
   <inline-formula id="pcbi.1008122.e048">
    <alternatives>
     <graphic id="pcbi.1008122.e048g" xlink:href="pcbi.1008122.e048" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     <math id="M48">
      <msup>
       <mover accent="true">
        <mi mathvariant="script">H</mi>
        <mo>^</mo>
       </mover>
       <mn>1</mn>
      </msup>
     </math>
    </alternatives>
   </inline-formula>), the transmission histories of individual 
   <italic>a</italic> and 
   <italic>b</italic> are (
   <italic>d</italic>
   <sub>
    <italic>a</italic>
   </sub> = 
   <italic>l</italic>
   <sub>1</sub>, 
   <italic>e</italic>
   <sub>
    <italic>a</italic>
   </sub> = 0) and (
   <italic>d</italic>
   <sub>
    <italic>b</italic>
   </sub> = 
   <italic>l</italic>
   <sub>2</sub> + 
   <italic>l</italic>
   <sub>3</sub>, 
   <italic>e</italic>
   <sub>
    <italic>b</italic>
   </sub> = 1) respectively. For the unlabeled branch 
   <italic>l</italic>
   <sub>
    <italic>ub</italic>
   </sub>, its labeling coefficient is evaluated as 
   <inline-formula id="pcbi.1008122.e049">
    <alternatives>
     <graphic id="pcbi.1008122.e049g" xlink:href="pcbi.1008122.e049" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     <math id="M49">
      <mrow>
       <msub>
        <mi>β</mi>
        <mrow>
         <mi>a</mi>
         <mi>b</mi>
        </mrow>
       </msub>
       <mo>=</mo>
       <mfrac>
        <mrow>
         <mi>P</mi>
         <mi>r</mi>
         <mi>o</mi>
         <mi>b</mi>
         <mo>{</mo>
         <mrow>
          <mo>(</mo>
          <msub>
           <mi>l</mi>
           <mn>1</mn>
          </msub>
          <mo>+</mo>
          <msub>
           <mi>l</mi>
           <mrow>
            <mi>u</mi>
            <mi>b</mi>
           </mrow>
          </msub>
          <mo>,</mo>
          <mn>1</mn>
          <mo>)</mo>
         </mrow>
         <mo>,</mo>
         <mrow>
          <mo>(</mo>
          <msub>
           <mi>l</mi>
           <mn>2</mn>
          </msub>
          <mo>+</mo>
          <msub>
           <mi>l</mi>
           <mn>3</mn>
          </msub>
          <mo>,</mo>
          <mn>1</mn>
          <mo>)</mo>
         </mrow>
         <mo>|</mo>
         <msup>
          <mover accent="true">
           <mi>Θ</mi>
           <mo>^</mo>
          </mover>
          <mn>1</mn>
         </msup>
         <mo>}</mo>
        </mrow>
        <mrow>
         <mi>P</mi>
         <mi>r</mi>
         <mi>o</mi>
         <mi>b</mi>
         <mo>{</mo>
         <mrow>
          <mo>(</mo>
          <msub>
           <mi>l</mi>
           <mn>1</mn>
          </msub>
          <mo>,</mo>
          <mn>0</mn>
          <mo>)</mo>
         </mrow>
         <mo>,</mo>
         <mrow>
          <mo>(</mo>
          <msub>
           <mi>l</mi>
           <mn>2</mn>
          </msub>
          <mo>+</mo>
          <msub>
           <mi>l</mi>
           <mn>3</mn>
          </msub>
          <mo>+</mo>
          <msub>
           <mi>l</mi>
           <mrow>
            <mi>u</mi>
            <mi>b</mi>
           </mrow>
          </msub>
          <mo>,</mo>
          <mn>2</mn>
          <mo>)</mo>
         </mrow>
         <mo>|</mo>
         <msup>
          <mover accent="true">
           <mi>Θ</mi>
           <mo>^</mo>
          </mover>
          <mn>1</mn>
         </msup>
         <mo>}</mo>
        </mrow>
       </mfrac>
      </mrow>
     </math>
    </alternatives>
   </inline-formula>.
  </p>
 </caption>
 <graphic xlink:href="pcbi.1008122.g002" xmlns:xlink="http://www.w3.org/1999/xlink"/>
</fig>
