<?xml version="1.0" encoding="UTF-8"?>
<p>The CA algorithm has been developed on the basis of the likelihood function for a transmission history 
 <inline-formula id="pcbi.1008122.e019">
  <alternatives>
   <graphic xlink:href="pcbi.1008122.e019.jpg" id="pcbi.1008122.e019g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M19">
    <mi mathvariant="script">H</mi>
   </math>
  </alternatives>
 </inline-formula>. Under the assumptions of our HBD model, not only the transmission events caused by different individuals occur independently, but also the multiple transmission events caused by one individual are independent. So the likelihood for the whole transmission history can be evaluated in terms of individuals. Let 
 <italic>x</italic>
 <sub>
  <italic>i</italic>
 </sub> and 
 <italic>d</italic>
 <sub>
  <italic>i</italic>
 </sub> (
 <italic>i</italic> = 1, ⋯, 
 <italic>n</italic>) denote the number of infections and the duration of the infectious period for individual 
 <italic>i</italic>, information which is contained in the transmission history 
 <inline-formula id="pcbi.1008122.e020">
  <alternatives>
   <graphic xlink:href="pcbi.1008122.e020.jpg" id="pcbi.1008122.e020g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M20">
    <mrow>
     <mi mathvariant="script">H</mi>
     <mo>=</mo>
     <msubsup>
      <mrow>
       <mo>{</mo>
       <mrow>
        <mo>(</mo>
        <msub>
         <mi>d</mi>
         <mi>i</mi>
        </msub>
        <mo>,</mo>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
        <mo>)</mo>
       </mrow>
       <mo>}</mo>
      </mrow>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </msubsup>
    </mrow>
   </math>
  </alternatives>
 </inline-formula>. The likelihood function is then given by 
 <disp-formula id="pcbi.1008122.e021">
  <alternatives>
   <graphic xlink:href="pcbi.1008122.e021.jpg" id="pcbi.1008122.e021g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M21">
    <mtable displaystyle="true">
     <mtr>
      <mtd>
       <mtable>
        <mtr>
         <mtd columnalign="left">
          <mrow>
           <mi>L</mi>
           <mo>(</mo>
           <mi>k</mi>
           <mo>,</mo>
           <mi>θ</mi>
           <mo>,</mo>
           <mi>γ</mi>
           <mo>|</mo>
           <mi mathvariant="script">H</mi>
           <mo>)</mo>
          </mrow>
         </mtd>
         <mtd/>
        </mtr>
        <mtr>
         <mtd columnalign="left">
          <mrow>
           <mo>∝</mo>
           <munderover>
            <mo>∏</mo>
            <mrow>
             <mi>i</mi>
             <mo>=</mo>
             <mn>1</mn>
            </mrow>
            <mi>n</mi>
           </munderover>
           <mi>P</mi>
           <mi>r</mi>
           <mi>o</mi>
           <mi>b</mi>
           <mrow>
            <mo>(</mo>
            <msub>
             <mi>d</mi>
             <mi>i</mi>
            </msub>
            <mo>,</mo>
            <msub>
             <mi>x</mi>
             <mi>i</mi>
            </msub>
            <mo>|</mo>
            <mi>k</mi>
            <mo>,</mo>
            <mi>θ</mi>
            <mo>,</mo>
            <mi>γ</mi>
            <mo>)</mo>
           </mrow>
          </mrow>
         </mtd>
         <mtd/>
        </mtr>
        <mtr>
         <mtd columnalign="left">
          <mrow>
           <mo>=</mo>
           <munderover>
            <mo>∏</mo>
            <mrow>
             <mi>i</mi>
             <mo>=</mo>
             <mn>1</mn>
            </mrow>
            <mi>n</mi>
           </munderover>
           <mo>∫</mo>
           <msubsup>
            <mi mathvariant="normal">λ</mi>
            <mi>i</mi>
            <msub>
             <mi>x</mi>
             <mi>i</mi>
            </msub>
           </msubsup>
           <msup>
            <mi>e</mi>
            <mrow>
             <mo>-</mo>
             <msub>
              <mi mathvariant="normal">λ</mi>
              <mi>i</mi>
             </msub>
             <msub>
              <mi>d</mi>
              <mi>i</mi>
             </msub>
            </mrow>
           </msup>
           <mo>*</mo>
           <msup>
            <mi>γ</mi>
            <mrow>
             <msub>
              <mn mathvariant="double-struck">1</mn>
              <mrow>
               <mi>D</mi>
               <mi>G</mi>
              </mrow>
             </msub>
             <mrow>
              <mo>(</mo>
              <mi>i</mi>
              <mo>)</mo>
             </mrow>
            </mrow>
           </msup>
           <msup>
            <mi>e</mi>
            <mrow>
             <mo>-</mo>
             <mi>γ</mi>
             <msub>
              <mi>d</mi>
              <mi>i</mi>
             </msub>
            </mrow>
           </msup>
           <mo>*</mo>
           <mfrac>
            <mn>1</mn>
            <mrow>
             <mi mathvariant="normal">Γ</mi>
             <mrow>
              <mo>(</mo>
              <mi>k</mi>
              <mo>)</mo>
             </mrow>
             <msup>
              <mi>θ</mi>
              <mi>k</mi>
             </msup>
            </mrow>
           </mfrac>
           <msubsup>
            <mi mathvariant="normal">λ</mi>
            <mi>i</mi>
            <mrow>
             <mi>k</mi>
             <mo>-</mo>
             <mn>1</mn>
            </mrow>
           </msubsup>
           <msup>
            <mi>e</mi>
            <mrow>
             <mo>-</mo>
             <mfrac>
              <msub>
               <mi mathvariant="normal">λ</mi>
               <mi>i</mi>
              </msub>
              <mi>θ</mi>
             </mfrac>
            </mrow>
           </msup>
           <mi>d</mi>
           <msub>
            <mi mathvariant="normal">λ</mi>
            <mi>i</mi>
           </msub>
          </mrow>
         </mtd>
         <mtd/>
        </mtr>
        <mtr>
         <mtd columnalign="left">
          <mrow>
           <mo>=</mo>
           <munderover>
            <mo>∏</mo>
            <mrow>
             <mi>i</mi>
             <mo>=</mo>
             <mn>1</mn>
            </mrow>
            <mi>n</mi>
           </munderover>
           <mfrac>
            <mrow>
             <mi mathvariant="normal">Γ</mi>
             <mo>(</mo>
             <msub>
              <mi>x</mi>
              <mi>i</mi>
             </msub>
             <mo>+</mo>
             <mi>k</mi>
             <mo>)</mo>
            </mrow>
            <mrow>
             <mi mathvariant="normal">Γ</mi>
             <mo>(</mo>
             <mi>k</mi>
             <mo>)</mo>
            </mrow>
           </mfrac>
           <mfrac>
            <msup>
             <mi>θ</mi>
             <msub>
              <mi>x</mi>
              <mi>i</mi>
             </msub>
            </msup>
            <msup>
             <mrow>
              <mo>(</mo>
              <mn>1</mn>
              <mo>+</mo>
              <mi>θ</mi>
              <msub>
               <mi>d</mi>
               <mi>i</mi>
              </msub>
              <mo>)</mo>
             </mrow>
             <mrow>
              <msub>
               <mi>x</mi>
               <mi>i</mi>
              </msub>
              <mo>+</mo>
              <mi>k</mi>
             </mrow>
            </msup>
           </mfrac>
           <mo>*</mo>
           <msup>
            <mi>γ</mi>
            <mrow>
             <msub>
              <mn mathvariant="double-struck">1</mn>
              <mrow>
               <mi>D</mi>
               <mi>G</mi>
              </mrow>
             </msub>
             <mrow>
              <mo>(</mo>
              <mi>i</mi>
              <mo>)</mo>
             </mrow>
            </mrow>
           </msup>
           <msup>
            <mi>e</mi>
            <mrow>
             <mo>-</mo>
             <mi>γ</mi>
             <msub>
              <mi>d</mi>
              <mi>i</mi>
             </msub>
            </mrow>
           </msup>
          </mrow>
         </mtd>
        </mtr>
       </mtable>
      </mtd>
     </mtr>
    </mtable>
   </math>
  </alternatives>
  <label>(1)</label>
 </disp-formula> where Γ(⋅) is the gamma function, and the indicator 
 <inline-formula id="pcbi.1008122.e022">
  <alternatives>
   <graphic xlink:href="pcbi.1008122.e022.jpg" id="pcbi.1008122.e022g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M22">
    <mrow>
     <msub>
      <mn mathvariant="double-struck">1</mn>
      <mrow>
       <mi>D</mi>
       <mi>G</mi>
      </mrow>
     </msub>
     <mrow>
      <mo>(</mo>
      <mi>i</mi>
      <mo>)</mo>
     </mrow>
    </mrow>
   </math>
  </alternatives>
 </inline-formula> in (
 <xref ref-type="disp-formula" rid="pcbi.1008122.e021">1</xref>) indicates if the infectious period 
 <italic>d</italic>
 <sub>
  <italic>i</italic>
 </sub> has ended before the end of the observation period. The parameters of (
 <italic>k</italic>, 
 <italic>θ</italic>) are parameterizations of 
 <italic>Gamma</italic> distribution under which the mean and standard deviation can be represented as 
 <italic>μ</italic>
 <sub>λ</sub> = 
 <italic>kθ</italic> and 
 <inline-formula id="pcbi.1008122.e023">
  <alternatives>
   <graphic xlink:href="pcbi.1008122.e023.jpg" id="pcbi.1008122.e023g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M23">
    <mrow>
     <msub>
      <mi>σ</mi>
      <mi mathvariant="normal">λ</mi>
     </msub>
     <mo>=</mo>
     <msqrt>
      <mi>k</mi>
     </msqrt>
     <mi>θ</mi>
    </mrow>
   </math>
  </alternatives>
 </inline-formula> respectively.
</p>
