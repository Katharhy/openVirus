<?xml version="1.0" encoding="UTF-8"?>
<p>We applied a modified IF2 algorithm (termed SR-IF2) to estimate the model state variables and parameters for each week in the 20-year study period. The original IF2 algorithm, developed by and described in detail in Ionides et al [
 <xref rid="pcbi.1007989.ref041" ref-type="bibr">41</xref>,
 <xref rid="pcbi.1007989.ref075" ref-type="bibr">75</xref>], implements an iterated, perturbed Bayes map for inference of partially observed dynamic systems. In each iteration, it uses a particle filter [
 <xref rid="pcbi.1007989.ref034" ref-type="bibr">34</xref>] to estimate the likelihood of the observed time series (here the A(H1N1)+, A(H3N2)+, and B+ time series altogether). The particle filter uses a suite of model replicates, each is initially randomly drawn from the prior, to represent samples of the latent dynamic variables. Over the course of filtering, the particles are numerically integrated forward in time per the dynamic model (here the multi-strain model in 
 <xref ref-type="disp-formula" rid="pcbi.1007989.e003">Eq 1</xref>) and resampled based on the likelihood to update the distribution of all model parameters/variables per Bayesâ€™ rule at each time step (here each week). At the end of the time series, model parameters are recycled as starting parameters for the next iteration. In theory, this procedure converges to the maximum likelihood estimate.
</p>
