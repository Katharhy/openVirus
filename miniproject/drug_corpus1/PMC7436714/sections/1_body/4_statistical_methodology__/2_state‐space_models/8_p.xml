<?xml version="1.0" encoding="UTF-8"?>
<p>In the earlier likelihood evaluation, one‐step prediction densities, 
 <italic>f</italic>
 <sub>
  <italic>t</italic>|
  <italic>t</italic>−1
 </sub>, and filter densities, 
 <italic>f</italic>
 <sub>
  <italic>t</italic>|
  <italic>t</italic>
 </sub>, can be respectively given by the recursions 
 <disp-formula id="insr12402-disp-0018">
  <label>(9)</label>
  <math id="nlm-math-35">
   <mtable class="align" columnalign="left">
    <mtr>
     <mtd class="align-1">
      <msub>
       <mrow>
        <mi>f</mi>
       </mrow>
       <mrow>
        <mi>t</mi>
        <mo stretchy="false">|</mo>
        <mi>t</mi>
        <mo>−</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mfenced separators="" open="(" close=")">
       <mrow>
        <msub>
         <mrow>
          <mi>θ</mi>
         </mrow>
         <mrow>
          <mi>t</mi>
         </mrow>
        </msub>
        <mo stretchy="false">|</mo>
        <msup>
         <mrow>
          <mi>y</mi>
         </mrow>
         <mrow>
          <mi>t</mi>
          <mo>−</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <mo>;</mo>
        <mi>τ</mi>
       </mrow>
      </mfenced>
     </mtd>
     <mtd class="align-2">
      <mo>=</mo>
      <msub>
       <mrow>
        <mo>∫</mo>
       </mrow>
       <mrow>
        <msup>
         <mrow>
          <mi>R</mi>
         </mrow>
         <mrow>
          <mi>q</mi>
         </mrow>
        </msup>
       </mrow>
      </msub>
      <msub>
       <mrow>
        <mi>f</mi>
       </mrow>
       <mrow>
        <mi>t</mi>
        <mo>−</mo>
        <mn>1</mn>
        <mo stretchy="false">|</mo>
        <mi>t</mi>
        <mo>−</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mfenced separators="" open="(" close=")">
       <mrow>
        <msub>
         <mrow>
          <mi>θ</mi>
         </mrow>
         <mrow>
          <mi>t</mi>
          <mo>−</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy="false">|</mo>
        <msup>
         <mrow>
          <mi>y</mi>
         </mrow>
         <mrow>
          <mi>t</mi>
          <mo>−</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <mo>;</mo>
        <mi>τ</mi>
       </mrow>
      </mfenced>
      <msub>
       <mrow>
        <mi>g</mi>
       </mrow>
       <mrow>
        <mi>t</mi>
       </mrow>
      </msub>
      <mo stretchy="false">(</mo>
      <msub>
       <mrow>
        <mi>θ</mi>
       </mrow>
       <mrow>
        <mi>t</mi>
       </mrow>
      </msub>
      <mo stretchy="false">|</mo>
      <msub>
       <mrow>
        <mi>θ</mi>
       </mrow>
       <mrow>
        <mi>t</mi>
        <mo>−</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>;</mo>
      <mi>τ</mi>
      <mo stretchy="false">)</mo>
      <mi>d</mi>
      <msub>
       <mrow>
        <mi>θ</mi>
       </mrow>
       <mrow>
        <mi>t</mi>
        <mo>−</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>,</mo>
     </mtd>
    </mtr>
   </mtable>
  </math>
 </disp-formula>
 <disp-formula id="insr12402-disp-1018">
  <label>(10)</label>
  <math id="nlm-math-36">
   <mtable class="align" columnalign="left">
    <mtr>
     <mtd class="align-1">
      <msub>
       <mrow>
        <mi>f</mi>
       </mrow>
       <mrow>
        <mi>t</mi>
        <mo stretchy="false">|</mo>
        <mi>t</mi>
       </mrow>
      </msub>
      <mfenced separators="" open="(" close=")">
       <mrow>
        <msub>
         <mrow>
          <mi>θ</mi>
         </mrow>
         <mrow>
          <mi>t</mi>
         </mrow>
        </msub>
        <mo stretchy="false">|</mo>
        <msup>
         <mrow>
          <mi>y</mi>
         </mrow>
         <mrow>
          <mi>t</mi>
         </mrow>
        </msup>
        <mo>;</mo>
        <mi>τ</mi>
       </mrow>
      </mfenced>
     </mtd>
     <mtd class="align-2">
      <mo>=</mo>
      <mfrac>
       <mrow>
        <msub>
         <mrow>
          <mi>f</mi>
         </mrow>
         <mrow>
          <mi>t</mi>
          <mo stretchy="false">|</mo>
          <mi>t</mi>
          <mo>−</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mfenced separators="" open="(" close=")">
         <mrow>
          <msub>
           <mrow>
            <mi>θ</mi>
           </mrow>
           <mrow>
            <mi>t</mi>
           </mrow>
          </msub>
          <mo stretchy="false">|</mo>
          <msup>
           <mrow>
            <mi>y</mi>
           </mrow>
           <mrow>
            <mi>t</mi>
            <mo>−</mo>
            <mn>1</mn>
           </mrow>
          </msup>
          <mo>;</mo>
          <mi>τ</mi>
         </mrow>
        </mfenced>
        <msub>
         <mrow>
          <mi>f</mi>
         </mrow>
         <mrow>
          <mi>t</mi>
         </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msub>
         <mrow>
          <mi>y</mi>
         </mrow>
         <mrow>
          <mi>t</mi>
         </mrow>
        </msub>
        <mo stretchy="false">|</mo>
        <msub>
         <mrow>
          <mi>θ</mi>
         </mrow>
         <mrow>
          <mi>t</mi>
         </mrow>
        </msub>
        <mo>;</mo>
        <mi>τ</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <msub>
         <mrow>
          <mo>∫</mo>
         </mrow>
         <mrow>
          <msup>
           <mrow>
            <mi>R</mi>
           </mrow>
           <mrow>
            <mi>q</mi>
           </mrow>
          </msup>
         </mrow>
        </msub>
        <msub>
         <mrow>
          <mi>f</mi>
         </mrow>
         <mrow>
          <mi>t</mi>
          <mo stretchy="false">|</mo>
          <mi>t</mi>
          <mo>−</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mfenced separators="" open="(" close=")">
         <mrow>
          <msub>
           <mrow>
            <mi>θ</mi>
           </mrow>
           <mrow>
            <mi>t</mi>
           </mrow>
          </msub>
          <mo stretchy="false">|</mo>
          <msup>
           <mrow>
            <mi>y</mi>
           </mrow>
           <mrow>
            <mi>t</mi>
            <mo>−</mo>
            <mn>1</mn>
           </mrow>
          </msup>
          <mo>;</mo>
          <mi>τ</mi>
         </mrow>
        </mfenced>
        <msub>
         <mrow>
          <mi>f</mi>
         </mrow>
         <mrow>
          <mi>t</mi>
         </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msub>
         <mrow>
          <mi>y</mi>
         </mrow>
         <mrow>
          <mi>t</mi>
         </mrow>
        </msub>
        <mo stretchy="false">|</mo>
        <msub>
         <mrow>
          <mi>θ</mi>
         </mrow>
         <mrow>
          <mi>t</mi>
         </mrow>
        </msub>
        <mo>;</mo>
        <mi>τ</mi>
        <mo stretchy="false">)</mo>
        <mi>d</mi>
        <msub>
         <mrow>
          <mi>θ</mi>
         </mrow>
         <mrow>
          <mi>t</mi>
         </mrow>
        </msub>
       </mrow>
      </mfrac>
      <mo>,</mo>
     </mtd>
    </mtr>
   </mtable>
  </math>
 </disp-formula> with the recursion starting with 
 <italic>f</italic>
 <sub>0|0</sub>(
 <italic>θ</italic>)=
 <italic>p</italic>
 <sub>0</sub>(
 <italic>θ</italic>). In general, exact evaluation of the integrals in (
 <xref rid="insr12402-disp-0018" ref-type="disp-formula">9</xref>) and (10) is analytically unavailable, unless in some simple situations, such as both processes being linear and normally distributed. For the linear Gaussian state‐space model, all 
 <italic>f</italic>
 <sub>
  <italic>t</italic>|
  <italic>s</italic>
 </sub> are Gaussian, so the first two moments of (
 <xref rid="insr12402-disp-0018" ref-type="disp-formula">9</xref>) and (10) can be easily derived from the conventional Kalman filtering procedure, as discussed in Chapter 9 of Song (
 <xref rid="insr12402-bib-0082" ref-type="ref">2007</xref>). However, with some computational costs, all integrals in the earlier likelihood and the filter can be evaluated numerically by MCMC methods.
</p>
