<?xml version="1.0" encoding="UTF-8"?>
<p id="p0042">To address the second restriction, we can add two more sets of indicator variables and constraints, keeping track of whether a lab sends out or receives swabs. Note that the black-box commercial solver we use (Gurobi) converts all indicator constraints presented in this section into linear constraints. The new variables are 
 <inline-formula>
  <math id="M33" altimg="si35.svg">
   <mrow>
    <msubsup>
     <mi>γ</mi>
     <mrow>
      <mi>l</mi>
      <mi>t</mi>
     </mrow>
     <mo>+</mo>
    </msubsup>
    <mo>,</mo>
    <msubsup>
     <mi>γ</mi>
     <mrow>
      <mi>l</mi>
      <mi>t</mi>
     </mrow>
     <mo>−</mo>
    </msubsup>
    <mo>∈</mo>
    <mrow>
     <mo>{</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mn>1</mn>
     <mo>}</mo>
    </mrow>
    <mo>,</mo>
   </mrow>
  </math>
 </inline-formula> which assume value 1 iff, respectively, lab 
 <italic>l</italic> sends or receives swabs on day 
 <italic>t</italic>. The necessary constraints to link these variables and enforce the restriction are:
 <disp-formula id="eq0017">
  <label>(17)</label>
  <math id="M34" altimg="si36.svg">
   <mrow>
    <msubsup>
     <mi>γ</mi>
     <mrow>
      <mi>l</mi>
      <mi>t</mi>
     </mrow>
     <mo>+</mo>
    </msubsup>
    <mo linebreak="goodbreak">=</mo>
    <mn>1</mn>
    <mo>→</mo>
    <munder>
     <mo>∑</mo>
     <mtable>
      <mtr>
       <mtd>
        <mrow>
         <msup>
          <mi>l</mi>
          <mo>′</mo>
         </msup>
         <mo>∈</mo>
         <mi>L</mi>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mrow>
         <msup>
          <mi>l</mi>
          <mo>′</mo>
         </msup>
         <mo>≠</mo>
         <mi>l</mi>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
    </munder>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>l</mi>
      <msup>
       <mi>l</mi>
       <mo>′</mo>
      </msup>
      <mi>t</mi>
     </mrow>
    </msub>
    <mo>≥</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mspace width="1em"/>
    <msubsup>
     <mi>γ</mi>
     <mrow>
      <mi>l</mi>
      <mi>t</mi>
     </mrow>
     <mo>+</mo>
    </msubsup>
    <mo linebreak="goodbreak">=</mo>
    <mn>0</mn>
    <mo>→</mo>
    <munder>
     <mo>∑</mo>
     <mtable>
      <mtr>
       <mtd>
        <mrow>
         <msup>
          <mi>l</mi>
          <mo>′</mo>
         </msup>
         <mo>∈</mo>
         <mi>L</mi>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mrow>
         <msup>
          <mi>l</mi>
          <mo>′</mo>
         </msup>
         <mo>≠</mo>
         <mi>l</mi>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
    </munder>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>l</mi>
      <msup>
       <mi>l</mi>
       <mo>′</mo>
      </msup>
      <mi>t</mi>
     </mrow>
    </msub>
    <mo linebreak="goodbreak">=</mo>
    <mn>0</mn>
    <mspace width="2.em"/>
    <mo>∀</mo>
    <mi>l</mi>
    <mo>∈</mo>
    <mi>L</mi>
    <mo>,</mo>
    <mspace width="1em"/>
    <mo>∀</mo>
    <mi>t</mi>
    <mo>∈</mo>
    <mi>T</mi>
   </mrow>
  </math>
 </disp-formula>
 <disp-formula id="eq0018">
  <label>(18)</label>
  <math id="M35" altimg="si37.svg">
   <mrow>
    <msubsup>
     <mi>γ</mi>
     <mrow>
      <mi>l</mi>
      <mi>t</mi>
     </mrow>
     <mo>−</mo>
    </msubsup>
    <mo linebreak="goodbreak">=</mo>
    <mn>1</mn>
    <mo>→</mo>
    <munder>
     <mo>∑</mo>
     <mtable>
      <mtr>
       <mtd>
        <mrow>
         <msup>
          <mi>l</mi>
          <mo>′</mo>
         </msup>
         <mo>∈</mo>
         <mi>L</mi>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mrow>
         <msup>
          <mi>l</mi>
          <mo>′</mo>
         </msup>
         <mo>≠</mo>
         <mi>l</mi>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
    </munder>
    <msub>
     <mi>y</mi>
     <mrow>
      <msup>
       <mi>l</mi>
       <mo>′</mo>
      </msup>
      <mi>l</mi>
      <mi>t</mi>
     </mrow>
    </msub>
    <mo>≥</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mspace width="1em"/>
    <msubsup>
     <mi>γ</mi>
     <mrow>
      <mi>l</mi>
      <mi>t</mi>
     </mrow>
     <mo>−</mo>
    </msubsup>
    <mo linebreak="goodbreak">=</mo>
    <mn>0</mn>
    <mo>→</mo>
    <munder>
     <mo>∑</mo>
     <mtable>
      <mtr>
       <mtd>
        <mrow>
         <msup>
          <mi>l</mi>
          <mo>′</mo>
         </msup>
         <mo>∈</mo>
         <mi>L</mi>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mrow>
         <msup>
          <mi>l</mi>
          <mo>′</mo>
         </msup>
         <mo>≠</mo>
         <mi>l</mi>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
    </munder>
    <msub>
     <mi>y</mi>
     <mrow>
      <msup>
       <mi>l</mi>
       <mo>′</mo>
      </msup>
      <mi>l</mi>
      <mi>t</mi>
     </mrow>
    </msub>
    <mo linebreak="goodbreak">=</mo>
    <mn>0</mn>
    <mspace width="2.em"/>
    <mo>∀</mo>
    <mi>l</mi>
    <mo>∈</mo>
    <mi>L</mi>
    <mo>,</mo>
    <mspace width="1em"/>
    <mo>∀</mo>
    <mi>t</mi>
    <mo>∈</mo>
    <mi>T</mi>
   </mrow>
  </math>
 </disp-formula>
 <disp-formula id="eq0019">
  <label>(19)</label>
  <math id="M36" altimg="si38.svg">
   <mrow>
    <msubsup>
     <mi>γ</mi>
     <mrow>
      <mi>l</mi>
      <mi>t</mi>
     </mrow>
     <mo>+</mo>
    </msubsup>
    <mo linebreak="goodbreak">+</mo>
    <msubsup>
     <mi>γ</mi>
     <mrow>
      <mi>l</mi>
      <mi>t</mi>
     </mrow>
     <mo>−</mo>
    </msubsup>
    <mo>≤</mo>
    <mn>1</mn>
    <mspace width="131.0pt"/>
    <mo>∀</mo>
    <mi>l</mi>
    <mo>∈</mo>
    <mi>L</mi>
    <mo>,</mo>
    <mspace width="1em"/>
    <mo>∀</mo>
    <mi>t</mi>
    <mo>∈</mo>
    <mi>T</mi>
    <mtext>.</mtext>
   </mrow>
  </math>
 </disp-formula>
</p>
