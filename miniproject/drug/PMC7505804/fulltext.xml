<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN" "JATS-archivearticle1-mathml3.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?DTDIdentifier.IdentifierValue http://null/schema/dtds/document/fulltext/xcr/xocs-article.xsd?><?DTDIdentifier.IdentifierType schema?><?SourceDTD.DTDName xocs-article.xsd?><?SourceDTD.Version 1.0?><?ConverterInfo.XSLTName ftrr2jats.xsl?><?ConverterInfo.Version 1?><?origin publisher?><?OLF?><front><journal-meta><journal-id journal-id-type="nlm-ta">Omega</journal-id><journal-title-group><journal-title>Omega</journal-title></journal-title-group><issn pub-type="ppub">0305-0483</issn><issn pub-type="epub">0305-0483</issn><publisher><publisher-name>Elsevier Ltd.</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">7505804</article-id><article-id pub-id-type="pii">S0305-0483(20)30695-2</article-id><article-id pub-id-type="doi">10.1016/j.omega.2020.102341</article-id><article-id pub-id-type="publisher-id">102341</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Optimising the assignment of swabs and reagent for PCR testing during a viral epidemic<sup><xref ref-type="fn" rid="d33e2990">&#x02606;</xref></sup></article-title></title-group><contrib-group><contrib contrib-type="author" id="au0001"><name><surname>Santini</surname><given-names>Alberto</given-names></name></contrib><aff id="aff0001">Universitat Pompeu Fabra, Barcelona, Spain</aff></contrib-group><pub-date pub-type="pmc-release"><day>22</day><month>9</month><year>2020</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.--><pub-date pub-type="epub"><day>22</day><month>9</month><year>2020</year></pub-date><elocation-id>102341</elocation-id><history><date date-type="received"><day>4</day><month>5</month><year>2020</year></date><date date-type="rev-recd"><day>3</day><month>9</month><year>2020</year></date><date date-type="accepted"><day>18</day><month>9</month><year>2020</year></date></history><permissions><copyright-statement>&#x000a9; 2020 Elsevier Ltd. All rights reserved.</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Elsevier Ltd</copyright-holder><license><license-p>Since January 2020 Elsevier has created a COVID-19 resource centre with free information in English and Mandarin on the novel coronavirus COVID-19. The COVID-19 resource centre is hosted on Elsevier Connect, the company's public news and information website. Elsevier hereby grants permission to make all its COVID-19-related research that is available on the COVID-19 resource centre - including this research content - immediately available in PubMed Central and other publicly funded repositories, such as the WHO COVID database with rights for unrestricted research re-use and analyses in any form or by any means with acknowledgement of the original source. These permissions are granted for free by Elsevier for as long as the COVID-19 resource centre remains active.</license-p></license></permissions><abstract abstract-type="author-highlights" id="absh001"><title>Highlights</title><p><list list-type="simple" id="lst0002"><list-item id="lstitem0001"><label>&#x02022;</label><p id="p0001">Large-scale quick testing is of primary importance during a viral epidemic.</p></list-item><list-item id="lstitem0002"><label>&#x02022;</label><p id="p0002">Tests are hindered by the lack of chemical reagents, acting as a bottleneck.</p></list-item><list-item id="lstitem0003"><label>&#x02022;</label><p id="p0003">We show how optimising the allocation of reagents increases test capabilities.</p></list-item><list-item id="lstitem0004"><label>&#x02022;</label><p id="p0004">We encourage cross-regional collaboration to expand a country&#x02019;s test capacity.</p></list-item></list></p></abstract><abstract id="abs0001"><p>Early large-scale swab testing is a fundamental tool for health authorities to assess the prevalence of a virus and enact appropriate mitigation measures during an epidemic. The COVID-19 pandemic has shown that the availability of chemical reagent required to carry out the tests is often a bottleneck in increasing a country&#x02019;s testing capacity. Further, demand is unevenly spread between more affected regions (which require more tests they can perform) and less affected ones (which have spare capacity). These issues hint at the opportunity of increasing test capacity via the optimal allocation of swabs and reagent to laboratories. We prove that this is the case, proposing an Integer Programming formulation to maximise the number of tests a country can perform and validating our approach on both real-life data from Italy and synthetic instances. Our results show that increased inter-regional collaboration and a steadier supply of reagent (i.e., coming from local production sites rather than international shipments) can dramatically increase testing capacity. Accordingly, we propose short-term and long-term recommendations for policy makers and health authorities.</p></abstract><kwd-group id="keys0001"><title>Keywords</title><kwd>Production planning</kwd><kwd>Healthcare optimization</kwd><kwd>Covid-19</kwd></kwd-group></article-meta></front><body><sec id="sec0001"><label>1</label><title>Introduction</title><p id="p0005">Viruses are pathogens that replicate after penetrating the living cells of other organisms. Outside cells, a virus is nothing more than genetic material (DNA or RNA) surrounded by protective layers of proteins and lipids. Once inside a host cell, the virus uses the cell&#x02019;s structures to replicate its genetic material and assembly its protective layers, thus creating a copy of itself. At the end, it kills the cell to release both the original and the copy.</p><p id="p0006">Viruses cause a host of human diseases, ranging from the common cold to AIDS. Of particular interest for this work is the recent <italic>Coronavirus disease 2019</italic> (COVID-19) pandemic. Under particular circumstances, a virus (and the disease it causes) can spread to a large part of a population in a short time, leading to an <italic>epidemic</italic>. When the epidemic spreads across national borders and infects people worldwide, it is termed a <italic>pandemic</italic>. SARS-CoV-2, the virus spreading COVID-19, for example, possessed the right characteristics to turn its associated disease into a pandemic: people carrying the virus do not show symptoms for an average of five days, during which they can spread the virus to others <xref rid="bib0044" ref-type="bibr">[44]</xref>; its basic reproduction number has been estimated between 1.4 and 5.7, i.e., each infected person in turns infects an average of up to 5.7 people <xref rid="bib0033" ref-type="bibr">[33]</xref>; up to 44% of patients show no symptoms at all during the infection period, making their diagnosis difficult <xref rid="bib0029" ref-type="bibr">[29]</xref>.</p><p id="p0007">Massive testing of the population is a fundamental part of the response against epidemics and pandemics. When carriers of the virus remain asymptomatic while infecting others, as for COVID-19, testing is one of the main tools health authorities can deploy to contain the spread of the disease <xref rid="bib0037" ref-type="bibr">[37]</xref>.</p><p id="p0008">Viruses such as SARS-CoV-2 are RNA viruses, i.e., they contain a single strand of nucleotides rather than the &#x0201c;double helix&#x0201d; typical of DNA. For this brief introduction, we call the four nucleotides composing the RNA chain with their initials: A, C, G, U. The quickest available test for RNA viruses uses <italic>real-time reverse transcription polymerase chain reaction</italic> (rRT-PCR). A popular test consists in collecting a sample of nasal secretions on a swab <xref rid="bib0007" ref-type="bibr">[7]</xref>, looking for an RNA subsequence which is unique to the virus. To identify this subsequence, the tester uses inverse RNA: a sequence of nucleotides which pairs those they are looking for (remember that A pairs with U and C with G). If the sample contains viral RNA, it will pair with the chain injected by the tester. Once the nucleotides are paired, they effectively transform the single-strand RNA into double-strand DNA. To detect a significant presence of the viral DNA, the genetic material goes through an amplification process, the polymerase chain reaction <xref rid="bib0006" ref-type="bibr">[6]</xref>. Both transforming RNA into DNA, and amplifying it, cannot happen without certain enzymes, commonly called <italic>reagents</italic>. While this simplified description is enough to introduce our problem, we refer the reader to the reviews of <xref rid="bib0004" ref-type="bibr">[4]</xref>, <xref rid="bib0016" ref-type="bibr">[16]</xref> for a more accurate description of the rRT-PCR technique. <xref rid="fig0001" ref-type="fig">Fig.&#x000a0;1</xref>
is an example of a protocol for rRT-PCR tests used by the United Kingdom&#x02019;s National Health Service.<fig id="fig0001"><label>Fig. 1</label><caption><p>United Kingdom National Health Service&#x02019;s protocol for rRT-PCR analysis of samples from swabs, to detect COVID-19.</p></caption><alt-text id="at0001">Fig. 1</alt-text><graphic xlink:href="gr1_lrg"/></fig></p><p id="p0009">During the COVID-19 pandemic, laboratory capacities and reagent availability have become the bottleneck for increasing the number of tests in much of Europe, North America and Asia <xref rid="bib0001" ref-type="bibr">[1]</xref>, <xref rid="bib0013" ref-type="bibr">[13]</xref>, <xref rid="bib0027" ref-type="bibr">[27]</xref>, <xref rid="bib0043" ref-type="bibr">[43]</xref>. Therefore, health authorities need to optimise the allocation of resources to their test laboratories, starting from the distribution of reagent and the assignments of testing tasks. With this work, we use tools from Operational Research to help decision makers maximise the number of tests they can conduct while limited by reagent availability and logistic constraints.</p><p id="p0010">Our main <bold>contributions</bold> are the following.<list list-type="simple" id="lst0003"><list-item id="lstitem0005"><label>&#x02022;</label><p id="p0011">We introduce the problem of maximising a country&#x02019;s test capacity for rRT-PCR tests, during the outbreak of an epidemic. In such a situation, (i) reagent scarcity is often a bottleneck for testing, and (ii) some regions are foci of the disease, requiring more tests than others. These two conditions provide an opportunity to optimise the allocation of reagent and swabs, with the aim of maximising the number of swabs tested and reducing the wait time for results.</p></list-item><list-item id="lstitem0006"><label>&#x02022;</label><p id="p0012">We provide an Integer Programming formulation for this problem, extend it to consider the real-world case in which the health-care system is decentralised at the regional level, and consider a hierarchical multi-objective version of the problem. Because commercial software such as Gurobi solves the formulation in a few minutes, this model is suitable for direct use by public health decision makers and to run what-if analyses.</p></list-item><list-item id="lstitem0007"><label>&#x02022;</label><p id="p0013">We conduct two case studies to validate our approach. In the first one, we use real-life data referring to the Italian situation during the COVID-19 pandemic. Our analysis confirms that fostering inter-regional collaboration can increase by up to <inline-formula><mml:math id="M1" altimg="si5.svg"><mml:mrow><mml:mo>+</mml:mo><mml:mn>40</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> the number of swabs tested during a 13-day planning horizon. In the second one, we use synthetic data to determine the most important factors which impact testing capacity. We conclude that a strong industrial network able to provide a steady supply of reagent provides the greatest advantage, vs. procuring reagent via sporadic shipments, even when the total purchased quantity stays the same. Further, countries with limited lab infrastructure should prioritise acquiring more machines and training more personnel, while increasing inter-regional coordination helps those countries with a developed laboratory network.</p></list-item><list-item id="lstitem0008"><label>&#x02022;</label><p id="p0014">We make available both our data and the code we used, under an open-source license <xref rid="bib0035" ref-type="bibr">[35]</xref>.</p></list-item></list>
</p></sec><sec id="sec0002"><label>2</label><title>Problem description</title><p id="p0015">In our problem, a set of laboratories <inline-formula><mml:math id="M2" altimg="si6.svg"><mml:mrow><mml:mi>L</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>L</mml:mi><mml:mo>|</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> has to perform rRT-PCR tests on swabs during a time horizon <inline-formula><mml:math id="M3" altimg="si7.svg"><mml:mrow><mml:mi>T</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> (each time unit corresponds to a day). We assume, without loss of generality, that for each swab a lab needs one unit of reagent. This allows to consider different testing routines, such as group testing, by rescaling the amount of reagent needed to test one swab. Each lab <italic>l</italic>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> starts with a reserve <italic>&#x003c1;</italic>
<sub><italic>l</italic>0</sub> of reagent at the beginning of the time horizon. The labs can receive further units of reagent from factories <inline-formula><mml:math id="M4" altimg="si8.svg"><mml:mrow><mml:mi>R</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>R</mml:mi><mml:mo>|</mml:mo><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> limited by their production capacity. Each factory <italic>r</italic>&#x000a0;&#x02208;&#x000a0;<italic>R</italic> produces <italic>f<sub>rt</sub></italic> units of reagent on day <italic>t</italic>&#x000a0;&#x02208;&#x000a0;<italic>T</italic>. Factories also store an initial amount <italic>&#x003c1;</italic>
<sub><italic>r</italic>0</sub> of reagent at the beginning of the planning horizon. A factory can also model other types of facilities; for example, a warehouse receiving new reagent once per week, or even a one-time shipment from a foreign country.</p><p id="p0016">Each laboratory <italic>l</italic> has a capacity <italic>Q<sub>l</sub></italic> of swabs it can test during one day. This capacity applies even if the lab has a larger amount of reagent, due to limitations on available machinery and workforce. The effective testing capacity of <italic>l</italic>, then, is the minimum between <italic>Q<sub>l</sub></italic> and the amount of reagent available at <italic>l</italic>.</p><p id="p0017">A lab <italic>l</italic>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> is tasked with testing <italic>m<sub>lt</sub></italic> swabs on day <italic>t</italic>, according to a predefined schedule to meet epidemiological needs. If a laboratory does not have enough reagent to test all the swabs, the decision-maker has three options: (i) moving some reagent from a factory to the lab,(ii) moving some swabs to another lab, or (iii) storing the swabs and schedule their testing for another day.<statement id="uenun0001"><label>Remark</label><p id="p0018">We assume the planner has already chosen the laboratory to which he assigns the swabs. More generally, though, a planner might need that swabs be tested in a given region, without any constraint on which specific lab performs the test, as long as they are geographically close to the point where the swabs were collected. In <xref rid="sec0007" ref-type="sec">Section&#x000a0;5.1</xref>, we will extend the model to take into account this general case, making the number of swabs assigned to each lab a decision variable. We also refer the reader to <xref rid="sec0008" ref-type="sec">Section&#x000a0;5.2</xref>, in which we introduce a fourth possibility for the decision maker: to move some reagent from a lab which has a surplus to one which is lacking.</p></statement>
</p><p id="p0019">The amount of reagent and swabs that a planner can move between locations each day is bounded by <italic>q</italic>
<sup>rg</sup> and <italic>q</italic>
<sup>sw</sup>, respectively.<statement id="uenun0002"><label>Remark</label><p id="p0020">We assume that quantities <italic>q</italic>
<sup>rg</sup> and <italic>q</italic>
<sup>sw</sup> are global capacity limits on the total amount of reagent and swab movements. Such an assumption rests on the observation that, during an epidemic, a central decision-maker manages logistic resources and can reallocate them from one area to another. If this were not the case, it would not be hard to enforce local limits, e.g., on the number of swabs that the planner can move out of a single laboratory. In a model extensions presented in <xref rid="sec0007" ref-type="sec">Section&#x000a0;5.1</xref>, locations are partitioned in regions and we impose region-specific capacity limits.</p></statement>
</p><p id="p0021">Given this input data, a planner must determine, for each day of the planning horizon, (i) how many units of reagent to move from the factories to the laboratories, and (ii) how many swabs to move between laboratories, with the aim of maximising the number of tests carried out.<statement id="uenun0003"><label>Remark</label><p id="p0022">While the main objective of the planner is to maximise the number of swabs tested, it is possible to account for secondary objectives. For example, because effective testing must be both large-scale and quick, one might want to minimise the average time swabs spend waiting at lab facilities. In <xref rid="sec0009" ref-type="sec">Section&#x000a0;5.3</xref> we propose a multi-objective extension of the problem in which, among all solutions which maximise the number of tests carried out, we select the one with lowest average waiting time.</p></statement>
</p></sec><sec id="sec0003"><label>3</label><title>Related work</title><p id="p0023">Our problem, described in <xref rid="sec0002" ref-type="sec">Section&#x000a0;2</xref>, resembles superficially problems in the area of production planning, material requirement planning and supply chain optimisation (for a complete overview on these topics see, e.g., Pochet and Wolsey <xref rid="bib0030" ref-type="bibr">[30]</xref>). In our case, carrying out tests corresponds to manufacturing a product using two raw materials (swabs and reagent); for us, though, the finished product demand (tested swabs) always matches one of the raw materials&#x02019; availability (swabs), while the other (reagent) acts as a bottleneck for production. As in production planning, we deal with the flow of goods over time, including shipments of raw material and inventory carry-over. We also allow the creation of backlogs, i.e., the storage of swabs which cannot be tested on the day of collection. Other characteristics of our problem, however, are not frequently considered in production planning optimisation: the geographic position of suppliers and production facilities (in our case, laboratories) and their regional subdivision; the possibility of reassigning orders between facilities, subject to logistics constraints; the uneven demand between regions.</p><p id="p0024">Most importantly, unlike problems in production planning, we disregard costs and focus exclusively on maximising production (in our case, number of tests). To this end, we do not consider transport, production, storage, raw material, order placement, personnel, nor opportunity costs, which instead have a prominent role when optimising commercial supply chains and production processes. In the standard case, in fact, the aim of the planner is pure cost minimisation <xref rid="bib0030" ref-type="bibr">[30]</xref> and satisfying the demand in full could even be sub-optimal, if the cost of producing one more unit is larger than the opportunity cost of missing a sale. Other approaches commonly used in production planning include multi-objective optimisation in which cost minimisation is tackled together with secondary objectives, such as demand satisfaction <xref rid="bib0026" ref-type="bibr">[26]</xref>, steadiness of production rates <xref rid="bib0040" ref-type="bibr">[40]</xref> or environmental performance <xref rid="bib0002" ref-type="bibr">[2]</xref>. Even in the healthcare sector, if considering times when authorities are not responding to an emergency, costs are taken into account. For example, Zhao et&#x000a0;al. <xref rid="bib0048" ref-type="bibr">[48]</xref> consider a drugs production planning problem in which they minimise both costs (avoiding over-production of drugs) and the duration of the trial. Other works (e.g., <xref rid="bib0010" ref-type="bibr">[10]</xref>, <xref rid="bib0014" ref-type="bibr">[14]</xref>) have considered the production and supply optimisation problems in the clinical area, but have focused on production and distribution of drugs in &#x0201c;normal&#x0201d; times, rather than during an emergency response to a sudden epidemic event.</p><p id="p0025">Literature focusing specifically on allocation of medical resources during emergencies mainly concentrates on the distribution of (life-saving) medical devices. As such, most models optimise the assignment of existing material to hospitals or individual patients, rather than the production and allocation of new material. Xiang and Zhuang <xref rid="bib0046" ref-type="bibr">[46]</xref>, for example, consider the problem of assigning medical resources to patients, taking into account that the conditions of patients left untreated will deteriorate over time. Cao and Huang <xref rid="bib0005" ref-type="bibr">[5]</xref> use a simulation approach in which they consider different strategies to allocate scarce medical resources (e.g., milder patients first, critical patients first, randomly) and complement an analysis of the utility of each strategy with ethical considerations on prioritising some patients over others.</p><p id="p0026">In the wake of the COVID-19 epidemics, the optimisation community has rushed to provide decision support tools for decision-makers involved in the fight against the virus. Similar to our work, researchers at MIT&#x02019;s Operations Research Center <xref rid="bib0008" ref-type="bibr">[8]</xref>, <xref rid="bib0009" ref-type="bibr">[9]</xref> have shown the advantages of inter-regional collaboration in sharing automatic ventilators across U.S.&#x000a0;states. Mehrotra et&#x000a0;al. <xref rid="bib0023" ref-type="bibr">[23]</xref> consider the same problem and use a stochastic model to show how sharing ventilators across states, even when each state is averse to the risk of not having enough machines for its own patients, can reduce the probability of shortages. The problem of allocating ventilator during influenza epidemics was already considered in the literature, e.g., by Huang et&#x000a0;al. <xref rid="bib0019" ref-type="bibr">[19]</xref>, Meltzer et&#x000a0;al. <xref rid="bib0024" ref-type="bibr">[24]</xref>, Zaza et&#x000a0;al. <xref rid="bib0047" ref-type="bibr">[47]</xref>.</p><p id="p0027">Lampariello and Sagratella <xref rid="bib0022" ref-type="bibr">[22]</xref> study a problem that, like ours, concerns diagnostic tests during the COVID-19 pandemics. The authors consider the problem of deciding how many swabs each region should collect to provide an accurate estimate of the prevalence of the disease among its population, while restricted by a nation-wide capacity limit on the number of tests performed. The problem is motivated by the practice employed in Italy during the early period of the epidemic, of double-checking at one single central laboratory (located in Rome) the results of each positive test conducted by local labs. The capacity of the central lab limits, in this case, the number of total expected positive results coming from all other labs in the country. Note how a decision maker working under the assumptions of <xref rid="bib0022" ref-type="bibr">[22]</xref> can use the model therein to generate regional demands <italic>m<sub>it</sub></italic>, which they can then feed to our model.</p><p id="p0028">Finally, Seccia <xref rid="bib0036" ref-type="bibr">[36]</xref> considers the problem of devising balanced rosters for nurses in hospitals while, due to the virus outbreak, there is both a peak in demand for nurses&#x02019; services and fewer available health professionals, because many are COVID-19-positive and confined at home.</p></sec><sec id="sec0004"><label>4</label><title>Model formulation</title><p id="p0029">We propose an Integer Programming model using the following sets of variables. The number of units of reagent moved from factory <italic>r</italic>&#x000a0;&#x02208;&#x000a0;<italic>R</italic> to lab <italic>l</italic>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> on day <italic>t</italic>&#x000a0;&#x02208;&#x000a0;<italic>T</italic> is denoted by variable <inline-formula><mml:math id="M5" altimg="si9.svg"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>. Variables <inline-formula><mml:math id="M6" altimg="si10.svg"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> represents the number of swabs going from laboratory <italic>l</italic>
<sub>1</sub>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> to <italic>l</italic>
<sub>2</sub>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> on day <italic>t</italic>&#x000a0;&#x02208;&#x000a0;<italic>T</italic>. The quantities of reagent stored, respectively, at factory <italic>r</italic>&#x000a0;&#x02208;&#x000a0;<italic>R</italic> and lab <italic>l</italic>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> on day <italic>t</italic>&#x000a0;&#x02208;&#x000a0;<italic>T</italic> are denoted by variables <inline-formula><mml:math id="M7" altimg="si11.svg"><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M8" altimg="si12.svg"><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>. Variables <inline-formula><mml:math id="M9" altimg="si13.svg"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> represent the number of swabs stored at lab <italic>l</italic>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> during day <italic>t</italic>&#x000a0;&#x02208;&#x000a0;<italic>T</italic>. Laboratories store swabs if they cannot carry out the tests on day <italic>t</italic> because of a lack of reagent necessary for the rRT-PCR procedure. We assume without loss of generality that, at the beginning of the time horizon, labs do not have any stored swab (<inline-formula><mml:math id="M10" altimg="si14.svg"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for all <italic>l</italic>&#x000a0;&#x02208;&#x000a0;<italic>L</italic>).</p><p id="p0030">Maximising the number of tests corresponds to minimising the number of swabs stored at labs at the end of the time horizon. The objective function, then, is:<disp-formula id="eq0001"><label>(1)</label><mml:math id="M11" altimg="si15.svg"><mml:mrow><mml:mi>min</mml:mi><mml:mspace width="1em"/><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mtext>.</mml:mtext></mml:mrow></mml:math></disp-formula>
</p><p id="p0031">The bounds on the quantities of reagent and swabs moved each day translate into the following two constraints:<disp-formula id="eq0002"><label>(2)</label><mml:math id="M12" altimg="si16.svg"><mml:mrow><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mtext>rg</mml:mtext></mml:msup><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0003"><label>(3)</label><mml:math id="M13" altimg="si17.svg"><mml:mrow><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mtext>sw</mml:mtext></mml:msup><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi><mml:mtext>.</mml:mtext></mml:mrow></mml:math></disp-formula>
</p><p id="p0032">The next constraints limit the number of tests carried out at each lab on a given day, based on the quantity of reagent available and lab capacities. To this end, it is convenient to introduce an auxiliary variable <inline-formula><mml:math id="M14" altimg="si18.svg"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> representing the number of tests carried out at lab <italic>l</italic>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> on day <italic>t</italic>&#x000a0;&#x02208;&#x000a0;<italic>T</italic>. Quantities <italic>m<sub>lt</sub></italic> (number of tests requested each day), <inline-formula><mml:math id="M15" altimg="si19.svg"><mml:mrow><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.16em"/><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (swabs moving from <italic>l</italic> to other labs), <inline-formula><mml:math id="M16" altimg="si20.svg"><mml:mrow><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.16em"/><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (swabs moving from other labs to <italic>l</italic>), <inline-formula><mml:math id="M17" altimg="si21.svg"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> (swabs backlog from the previous day) and <italic>z<sub>lt</sub></italic> (swabs stored at the end of the day) uniquely determine the value of <italic>w<sub>lt</sub></italic>, according to the linking relation<disp-formula id="eq0004"><label>(4)</label><mml:math id="M18" altimg="si22.svg"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi><mml:mtext>.</mml:mtext></mml:mrow></mml:math></disp-formula>
</p><p id="p0033">
<xref rid="fig0002" ref-type="fig">Fig.&#x000a0;2</xref>
shows this relation visually. In the figure, each node represents lab <italic>l</italic> on a different day and arrows display the flow of swabs in and out of the laboratory.<fig id="fig0002"><label>Fig. 2</label><caption><p>Linking relation between parameter <italic>m</italic> and variables <italic>y, z</italic> and <italic>w</italic> for a lab <italic>l</italic>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> at time intervals from <inline-formula><mml:math id="M19" altimg="si1.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak">&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="M20" altimg="si2.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><alt-text id="at0002">Fig. 2</alt-text><graphic xlink:href="gr2_lrg"/></fig></p><p id="p0034">With linking variables <italic>w<sub>lt</sub></italic>, we can constrain the number of tests performed with the following inequalities:<disp-formula id="eq0005"><label>(5)</label><mml:math id="M21" altimg="si23.svg"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0006"><label>(6)</label><mml:math id="M22" altimg="si24.svg"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p id="p0035">Next, we consider flow balance equations analogous to <xref rid="eq0004" ref-type="disp-formula">Eq.&#x000a0;(4)</xref>, relative to the number of reagent stored at factories and laboratories:<disp-formula id="eq0007"><label>(7)</label><mml:math id="M23" altimg="si25.svg"><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>r</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0008"><label>(8)</label><mml:math id="M24" altimg="si26.svg"><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mspace width="-0.16em"/><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi><mml:mrow><mml:mo mathvariant="normal">.</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
</p><p id="p0036">Constraint <xref rid="eq0007" ref-type="disp-formula">(7)</xref> states that the quantity of reagent in the factory&#x02019;s inventory at the beginning of the day, plus the quantity produced, is equal to the quantity in inventory at the end of the day, plus the quantity shipped to the labs. Constraint <xref rid="eq0008" ref-type="disp-formula">(8)</xref> equates, on the left-hand side, the quantity of reagent in the lab&#x02019;s inventory at the start of the day and the total amount received with, on the right-hand side, the inventory at the end of the day, plus the quantity of reagent used (or, which is the same, the number of tests performed). Because all variables are non-negative, constraint <xref rid="eq0008" ref-type="disp-formula">(8)</xref> makes constraint <xref rid="eq0005" ref-type="disp-formula">(5)</xref> redundant.</p><p id="p0037">Model <xref rid="eq0001" ref-type="disp-formula">(1)</xref>&#x02013;<xref rid="eq0008" ref-type="disp-formula">(8)</xref>, together with the following variable domain definitions, is the <bold>Base Model</bold> for our problem.<disp-formula id="eq0009"><label>(9)</label><mml:math id="M25" altimg="si27.svg"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>&#x02200;</mml:mo><mml:mi>r</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0010"><label>(10)</label><mml:math id="M26" altimg="si28.svg"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>&#x02200;</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">&#x02216;</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0011"><label>(11)</label><mml:math id="M27" altimg="si29.svg"><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>&#x02200;</mml:mo><mml:mi>r</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0012"><label>(12)</label><mml:math id="M28" altimg="si30.svg"><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
</p><sec id="sec0005"><label>4.1</label><title>Model strengthening</title><p id="p0038">A disadvantage of the <italic>Base Model</italic>
<xref rid="eq0001" ref-type="disp-formula">(1)</xref>&#x02013;<xref rid="eq0012" ref-type="disp-formula">(12)</xref> is that it suffers from symmetry. For example, consider any solution with slack capacity to transport swabs between two labs <italic>l</italic>
<sub>1</sub>, <italic>l</italic>
<sub>2</sub>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> during a day <italic>t</italic>&#x000a0;&#x02208;&#x000a0;<italic>T</italic>. One can get another solution of the same cost in which, on day <italic>t, l</italic>
<sub>1</sub> sends one more swab to <italic>l</italic>
<sub>2</sub> and <italic>l</italic>
<sub>2</sub> sends one more swab to <italic>l</italic>
<sub>1</sub>. To reduce symmetry, we impose two restrictions on the transport of swabs between labs: (i) a lab <italic>l</italic> can ship out swabs only if it is already working at full capacity, i.e., it is testing <italic>Q<sub>l</sub></italic> swabs or it ran out of reagent; (ii) a lab can only send or receive swabs during a given day, but not both.</p><p id="p0039">To tackle the first restriction, we introduce indicator variables <italic>&#x003b3;<sub>lt</sub></italic>&#x000a0;&#x02208;&#x000a0;{0, 1}, which take value 1 iff lab <italic>l</italic>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> is running at full capacity during day <italic>t</italic>&#x000a0;&#x02208;&#x000a0;<italic>T</italic>. These variables link to variables <italic>w</italic> and <italic>&#x003c1;</italic> via the following <italic>indicator constraints</italic> (see, e.g., <xref rid="bib0003" ref-type="bibr">[3]</xref>):<disp-formula id="eq0013"><label>(13)</label><mml:math id="M29" altimg="si31.svg"><mml:mrow><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02192;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo linebreak="goodbreak">&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0014"><label>(14)</label><mml:math id="M30" altimg="si32.svg"><mml:mrow><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02192;</mml:mo><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02265;</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0015"><label>(15)</label><mml:math id="M31" altimg="si33.svg"><mml:mrow><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02192;</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>&#x02228;</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi><mml:mtext>.</mml:mtext></mml:mrow></mml:math></disp-formula>
</p><p id="p0040">The restriction is, then, enforced with another indicator constraint:<disp-formula id="eq0016"><label>(16)</label><mml:math id="M32" altimg="si34.svg"><mml:mrow><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.33em"/><mml:mo>&#x02192;</mml:mo><mml:mspace width="0.33em"/><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi><mml:mtext>.</mml:mtext></mml:mrow></mml:math></disp-formula>
</p><p id="p0041">Constraint <xref rid="eq0016" ref-type="disp-formula">(16)</xref> guarantees that laboratory <italic>l</italic> cannot ship out swabs unless it is at full capacity.</p><p id="p0042">To address the second restriction, we can add two more sets of indicator variables and constraints, keeping track of whether a lab sends out or receives swabs. Note that the black-box commercial solver we use (Gurobi) converts all indicator constraints presented in this section into linear constraints. The new variables are <inline-formula><mml:math id="M33" altimg="si35.svg"><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>&#x02212;</mml:mo></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> which assume value 1 iff, respectively, lab <italic>l</italic> sends or receives swabs on day <italic>t</italic>. The necessary constraints to link these variables and enforce the restriction are:<disp-formula id="eq0017"><label>(17)</label><mml:math id="M34" altimg="si36.svg"><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02192;</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02265;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02192;</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="2.em"/><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0018"><label>(18)</label><mml:math id="M35" altimg="si37.svg"><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>&#x02212;</mml:mo></mml:msubsup><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02192;</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02265;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>&#x02212;</mml:mo></mml:msubsup><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02192;</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="2.em"/><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0019"><label>(19)</label><mml:math id="M36" altimg="si38.svg"><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo linebreak="goodbreak">+</mml:mo><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>&#x02212;</mml:mo></mml:msubsup><mml:mo>&#x02264;</mml:mo><mml:mn>1</mml:mn><mml:mspace width="131.0pt"/><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi><mml:mtext>.</mml:mtext></mml:mrow></mml:math></disp-formula>
</p><p id="p0043">Constraint <xref rid="eq0019" ref-type="disp-formula">(19)</xref> enforces that each lab, on each day, cannot both send and receive swabs. This restriction also avoids that a laboratory works as a relay, receiving and instantly re-shipping (i.e., &#x0201c;teleporting&#x0201d;) swabs between otherwise distant labs.</p><p id="p0044">The solutions produced by the <italic>Base Model</italic> can have another property which is undesirable in real-life applications: consider two laboratories <italic>l</italic>
<sub>1</sub>, <italic>l</italic>
<sub>2</sub>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> and two reagent factories <italic>r</italic>
<sub>1</sub>, <italic>r</italic>
<sub>2</sub>&#x000a0;&#x02208;&#x000a0;<italic>R</italic> such that <italic>l</italic>
<sub>1</sub> is closer to <italic>r</italic>
<sub>1</sub> than to <italic>r</italic>
<sub>2</sub> and <italic>l</italic>
<sub>2</sub> is closer to <italic>r</italic>
<sub>2</sub> than to <italic>r</italic>
<sub>1</sub>. The model allows <italic>l</italic>
<sub>1</sub> to buy reagent from the more distant factory <italic>r</italic>
<sub>2</sub> while <italic>l</italic>
<sub>2</sub> buys reagent from <italic>r</italic>
<sub>1</sub>. To avoid this counter-intuitive situation which represents a sub-optimal use of logistic resources, we introduce parameter <inline-formula><mml:math id="M37" altimg="si39.svg"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> representing the distance between lab <italic>l</italic>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> and factory <italic>r</italic>&#x000a0;&#x02208;&#x000a0;<italic>R</italic> and add the following constraint to the model:<disp-formula id="eq0020"><label>(20)</label><mml:math id="M38" altimg="si40.svg"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mo>&#x02228;</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi>R</mml:mi><mml:mspace width="0.28em"/><mml:mo>:</mml:mo><mml:mspace width="0.28em"/><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">&#x0003c;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="166.0pt"/><mml:mtext>and</mml:mtext><mml:mspace width="4.pt"/><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">&#x0003c;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mtext>.</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p><p id="p0045">While <xref rid="eq0020" ref-type="disp-formula">(20)</xref> refers to reagent, we add an analogous constraint to prevent moving swabs inefficiently:<disp-formula id="eq0021"><label>(21)</label><mml:math id="M39" altimg="si41.svg"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mo>&#x02228;</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>l</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>l</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mspace width="0.28em"/><mml:mo>:</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">&#x0003c;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="166.0pt"/><mml:mtext>and</mml:mtext><mml:mspace width="4.pt"/><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">&#x0003c;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:msub><mml:mrow><mml:mo mathvariant="normal">,</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> where <inline-formula><mml:math id="M40" altimg="si42.svg"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> is the distance between labs <italic>l</italic>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> and <italic>l</italic>&#x02032;&#x000a0;&#x02208;&#x000a0;<italic>L</italic>.</p></sec></sec><sec id="sec0006"><label>5</label><title>Model extensions</title><p id="p0046">In this section we propose extensions to the model presented above, to account for more realistic scenarios. We present an <bold>Extended Model</bold>, taking into account these considerations, in <xref rid="sec0016" ref-type="sec">Appendix&#x000a0;A</xref>.</p><sec id="sec0007"><label>5.1</label><title>Regional partitioning</title><p id="p0047">In <xref rid="sec0002" ref-type="sec">Section&#x000a0;2</xref> we mentioned two limitations of the <italic>Base Model</italic> which might not hold true in real-life applications. The first limitation is that there is a fixed quantity of swabs assigned to each laboratory. In most countries, central or regional health authorities oversee and plan testing. Swabs collected in a region, for example, might be sent for testing to any laboratory in the same region. The second limitation is that tests (and reagent) can move overnight from any location to any other location subject to global capacity limits. When applying the model to large countries, though, logistic constraints might impose that movement of material only happen between geographically close locations.</p><p id="p0048">To address these aspects, we extend the initial problem formulation as follows. The set of laboratories is partitioned as <inline-formula><mml:math id="M41" altimg="si43.svg"><mml:mrow><mml:mi>L</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x0222a;</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>&#x0222a;</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (with <inline-formula><mml:math id="M42" altimg="si44.svg"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>&#x02205;</mml:mi></mml:mrow></mml:math></inline-formula> for any two <inline-formula><mml:math id="M43" altimg="si45.svg"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mi>i</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>). We call each set composing the partition a <italic>region</italic>.</p><p id="p0049">The planner receives as input the number of swabs to test each day in each region <italic>L<sub>i</sub></italic>, denoted as <italic>m<sub>it</sub></italic>, but must determine how to split the swabs between the region&#x02019;s labs. A parameter <italic>&#x003b4;<sub>rl</sub></italic>&#x000a0;&#x02208;&#x000a0;{0, 1} determines whether a factory <italic>r</italic>&#x000a0;&#x02208;&#x000a0;<italic>R</italic> can ship reagent overnight to laboratory <italic>l</italic>&#x000a0;&#x02208;&#x000a0;<italic>L</italic>. Analogously, parameter <inline-formula><mml:math id="M44" altimg="si46.svg"><mml:mrow><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> determines whether two labs <italic>l</italic>
<sub>1</sub>, <italic>l</italic>
<sub>2</sub>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> can send each other swabs overnight.</p><p id="p0050">In our model, logistic capacities refer to each region. We consider, respectively, quantities <inline-formula><mml:math id="M45" altimg="si47.svg"><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mtext>rg</mml:mtext></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M46" altimg="si48.svg"><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mtext>sw</mml:mtext></mml:msubsup></mml:math></inline-formula> of reagent and swabs that can be shipped to region <inline-formula><mml:math id="M47" altimg="si49.svg"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> in a day. Depending on the logistic infrastructure, a planner could specify bounds at different levels of aggregation and for both inbound and outbound movements. For example, one might consider a maximum quantity of reagent shipped out of a factory, or a group of factories. Although we present here regional-level inbound capacities, our formulation is flexible enough to allow a wide array of modelling options.</p></sec><sec id="sec0008"><label>5.2</label><title>Transshipments of reagent</title><p id="p0051">A limitation of the <italic>Base Model</italic> is that it allows to move swabs but not reagent between laboratories. This reflects the conservative stance of laboratories, which are often unwilling to part with a scarce resource even if they have it in surplus, out of fear of running out later and not seeing their &#x0201c;favour&#x0201d; returned.</p><p id="p0052">Without capacities, moving swabs and reagent would be equivalent. For example, a lab <italic>l</italic>
<sub>1</sub> could send a swab it cannot test to another lab <italic>l</italic>
<sub>2</sub>, because <italic>l</italic>
<sub>1</sub> does not have enough reagent to test it; or, which is the same, <italic>l</italic>
<sub>2</sub> could send one unit of reagent to <italic>l</italic>
<sub>1</sub>, which could test their swab by themselves. In the presence of capacities determined by equipment and personnel availability, though, the two options are not interchangeable. In the example above, <italic>l</italic>
<sub>2</sub> might not have the capacity to test one more swab, while <italic>l</italic>
<sub>1</sub> could have it if provided with the necessary reagent.</p><p id="p0053">In light of the above considerations, we propose an extension of the model in which reagent can be forwarded between labs: a practice which goes by the name of <italic>transshipment</italic>. A planner can also use transshipments as a way to extend the radius at which factories send their products, by first storing them at a lab to which the factory ships and, when the need arises, forwarding them to other labs &#x02014; even if these labs were not originally reachable from the factory with an overnight shipment. Because reagent take one day to move between labs, we are indirectly introducing distance-based lead times in the reagent supply chain.</p><p id="p0054">To account for transshipment of reagent, we extend the model introducing a new set of variables <inline-formula><mml:math id="M48" altimg="si50.svg"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> indicating the amount of reagent moved from lab <italic>l</italic>
<sub>1</sub>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> to lab <italic>l</italic>
<sub>2</sub>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> on day <italic>t</italic>&#x000a0;&#x02208;&#x000a0;<italic>T</italic>. We assume that transshipments happen between laboratories which are close enough (<inline-formula><mml:math id="M49" altimg="si51.svg"><mml:mrow><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) and that a unit sent on day <italic>t</italic> is available on day <inline-formula><mml:math id="M50" altimg="si2.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p id="p0055">
<xref rid="fig0003" ref-type="fig">Fig.&#x000a0;3</xref>
shows the flow of reagent for a lab <italic>l</italic>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> when accounting for transshipments. Each day, the lab has in its availability the reagent already stored there, plus that received from factories and from other laboratories. At the same time, it uses some units of reagent to perform tests and eventually sends some to other labs; the remaining units go to the inventory for next day. In the model, we replace constraint <xref rid="eq0008" ref-type="disp-formula">(8)</xref> with the following:<disp-formula id="eq0022"><label>(22)</label><mml:math id="M51" altimg="si52.svg"><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi><mml:mrow><mml:mo mathvariant="normal">,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="M52" altimg="si53.svg"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="M53" altimg="si54.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> and constraint <xref rid="eq0002" ref-type="disp-formula">(2)</xref> with:<disp-formula id="eq0023"><label>(23)</label><mml:math id="M54" altimg="si55.svg"><mml:mrow><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mtext>rg</mml:mtext></mml:msup><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi><mml:mrow><mml:mo mathvariant="normal">.</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
<fig id="fig0003"><label>Fig. 3</label><caption><p>Flow of reagent for a lab <italic>l</italic>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> at time intervals from <inline-formula><mml:math id="M55" altimg="si1.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak">&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="M56" altimg="si3.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak">+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> when accounting for transshipments.</p></caption><alt-text id="at0003">Fig. 3</alt-text><graphic xlink:href="gr3_lrg"/></fig></p><p id="p0056">Lastly, we add a constraint analogous to <xref rid="eq0020" ref-type="disp-formula">(20)</xref> and <xref rid="eq0021" ref-type="disp-formula">(21)</xref> to ensure that reagent move efficiently between labs:<disp-formula id="eq0024"><label>(24)</label><mml:math id="M57" altimg="si56.svg"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mo>&#x02228;</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>l</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>l</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mspace width="0.28em"/><mml:mo>:</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="90.0pt"/><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">&#x0003c;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:msub><mml:mspace width="4.pt"/><mml:mtext>and</mml:mtext><mml:mspace width="4.pt"/><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">&#x0003c;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:msub><mml:mrow><mml:mo mathvariant="normal">.</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p></sec><sec id="sec0009"><label>5.3</label><title>Multi-objective model</title><p id="p0057">As discussed in <xref rid="sec0002" ref-type="sec">Section&#x000a0;2</xref>, the number of tests carried out is not the only important parameter for an effective testing campaign. Having fast results also helps assessing the disease&#x02019;s spread and enact appropriate and well-timed confinement and mitigation measures.</p><p id="p0058">We propose, then, a Multi-Objective Optimisation (MOO) approach to the problem. For a recent review of MOO applications in optimisation, we refer the reader to Gunantara <xref rid="bib0017" ref-type="bibr">[17]</xref>, Kalyanmoy <xref rid="bib0020" ref-type="bibr">[20]</xref>. In the following, we consider the hierarchical objective approach, in which the planner first optimises for their main objective (number of tests performed) and then, among all the solutions which give an optimal objective value, looks for the one optimising a secondary objective (mean test waiting time).</p><p id="p0059">Let <italic>Z</italic>* be the optimal objective value of model <xref rid="eq0027" ref-type="disp-formula">(27)</xref>&#x02013;<xref rid="eq0053" ref-type="disp-formula">(53)</xref>. We can obtain the solution to the hierarchical problem by solving the following <bold>Hierarchical Model</bold>:<disp-formula id="eq0025"><label>(25)</label><mml:math id="M58" altimg="si57.svg"><mml:mrow><mml:mi>min</mml:mi><mml:mspace width="1em"/><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0026"><label>(26)</label><mml:math id="M59" altimg="si58.svg"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>s.t.</mml:mtext><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:msup><mml:mi>Z</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>(28)</mml:mtext><mml:mo linebreak="goodbreak">&#x02212;</mml:mo><mml:mtext>(53)</mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> where <xref rid="eq0025" ref-type="disp-formula">Eq.&#x000a0;(25)</xref> minimises the sum of all amounts of swabs stored at labs waiting to be tested and <xref rid="eq0026" ref-type="disp-formula">Eq.&#x000a0;(26)</xref> imposes that the considered solutions match the optimal value with respect to objective function <xref rid="eq0027" ref-type="disp-formula">(27)</xref>. Objective function <xref rid="eq0025" ref-type="disp-formula">(25)</xref> is equivalent to minimising the average swab waiting time because <xref rid="eq0026" ref-type="disp-formula">(26)</xref> fixes the total number of swabs tested. When minimising the primary objective, two untested swabs collected, respectively, on the first and last day of the time horizon would contribute the same penalty. Adding the secondary objective avoids solution where old swabs remain untested for a long time, while newer ones get tested quickly.</p><p id="p0060">A planner could also add further objectives. For example, if he wants to guarantee a more equitable distribution of swabs to laboratories, he might want to minimise their avereage workload. To this end, we introduce a new variable <inline-formula><mml:math id="M60" altimg="si59.svg"><mml:mrow><mml:mi>W</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="M61" altimg="si60.svg"><mml:mrow><mml:mi>W</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>Q</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mfrac><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for all labs <italic>l</italic>&#x000a0;&#x02208;&#x000a0;<italic>L</italic>. Minmising <italic>W</italic> corresponds to minimising the highest average workload across all labs. Alternatively, if <inline-formula><mml:math id="M62" altimg="si61.svg"><mml:mrow><mml:mi>W</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mfrac><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>Q</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:math></inline-formula> for all <italic>l</italic>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> and <italic>t</italic>&#x000a0;&#x02208;&#x000a0;<italic>T</italic>, then minimising <italic>W</italic> amounts to minimising the peak workload over all labs and all days of the planning horizon.</p></sec></sec><sec id="sec0010"><label>6</label><title>Computational analysis</title><p id="p0061">We want to assess the impact of optimising the allocation of reagent and swabs to laboratories on the testing capacity of a country. We present two case studies. In the first, we perform an analysis on a realistic dataset relative to the Italian response to the COVID-19 pandemic, during the period from April 1st to April 13th, 2020. In the second, we use synthetic data to do a sensitivity analysis highlighting the decisions a planner can take to most increase testing capacity and lower waiting times. The datasets and the code used are available at <xref rid="bib0035" ref-type="bibr">[35]</xref>. We use the Hierarchical Model, which we solve using commercial solver Gurobi <xref rid="bib0018" ref-type="bibr">[18]</xref> with a time limit of 15 minutes for the primary and 5 minutes for the secondary objective, on a laptop equipped with a 4-core Intel i7 processor running at 1.6GHz. This time limit proved enough to solve to optimality the majority of instances, while those that remain open all show gaps smaller than 5% and, often, smaller than 1%.</p><sec id="sec0011"><label>6.1</label><title>Italy, April 1&#x02013;13, 2020</title><p id="p0062">We create a set of instances based on data sources relative to the COVID-19 pandemic in Italy <xref rid="bib0012" ref-type="bibr">[12]</xref>, <xref rid="bib0025" ref-type="bibr">[25]</xref>, <xref rid="bib0028" ref-type="bibr">[28]</xref>, <xref rid="bib0032" ref-type="bibr">[32]</xref>, <xref rid="bib0038" ref-type="bibr">[38]</xref>. We use data for the period 01&#x02013;13 April, 2020 for the entire national territory. <xref rid="fig0004" ref-type="fig">Fig.&#x000a0;4</xref>
a shows the distribution of laboratories and reagent factories in Italy <xref rid="bib0025" ref-type="bibr">[25]</xref>: dots represents labs which are officially authorised to execute COVID-19 swab tests by the Italian Health Ministry, while stars represent factories whose testing kits (including reagent, extraction kits, probes, negative controls) have been certified for use in COVID-19 swab testing. <xref rid="fig0004" ref-type="fig">Fig.&#x000a0;4</xref>b reports the number of swabs analysed in Italy during the period 01&#x02013;13 April, 2020, on a regional basis. We note that there is no publicly available data on the average wait times between swab collection and analysis.<fig id="fig0004"><label>Fig. 4</label><caption><p>Regional-level data for Italy.</p></caption><alt-text id="at0004">Fig. 4</alt-text><graphic xlink:href="gr4_lrg"/></fig></p><p id="p0063">We analyse the number of swabs tested, day by day and region by region, using five different scenarios. The first uses the official numbers released by Italy&#x02019;s &#x0201c;<italic>Dipartimento della Protezione Civile</italic>&#x0201d;, which we refer to as <bold>Real Data</bold>. Next, we consider the output obtained by the Hierarchical Model, under the following hypotheses. Swabs collected in a region cannot be sent to other regions, but can be allocated to any laboratory within the collection region (for this reason we label this data as <bold>Model - Regional</bold>). In modelling terms, this corresponds to setting <inline-formula><mml:math id="M63" altimg="si51.svg"><mml:mrow><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if and only if, for two labs <italic>l</italic>
<sub>1</sub>, <italic>l</italic>
<sub>2</sub>&#x000a0;&#x02208;&#x000a0;<italic>L</italic>, there is a region <italic>L<sub>k</sub></italic> such that <italic>l</italic>
<sub>1</sub>, <italic>l</italic>
<sub>2</sub>&#x000a0;&#x02208;&#x000a0;<italic>L<sub>k</sub></italic>. We use this hypothesis to model how testing happens in Italy, with local laboratories and regional &#x0201c;reference laboratories&#x0201d; collecting swabs from all-over the region and providing double checks before non-urgent hospital admissions (emergency patients are admitted even before test results are ready) and discharges. Also remind that the Italian healthcare system is managed on a regional basis, with ample autonomy given to the local health authorities but little inter-regional interaction <xref rid="bib0015" ref-type="bibr">[15]</xref>. We assume that labs can procure reagent from their geographically closest factory, and that procurement is optimised by a planner deciding the quantities of reagent sent to each laboratory, to maximise the number of tested swabs. This assumption reflects how Italian regions were procuring supplies autonomously, before the central government created and rendered operational a COVID-19 Commissariat which also acted as a national procurement centre <xref rid="bib0011" ref-type="bibr">[11, Art.&#x000a0;122]</xref>.</p><p id="p0064">Because news sources and press releases by regional health authorities (we found statements by authorities of Basilicata, Campania, Emilia-Romagna, Marche, Lombardia, Piemonte, Puglia, Sardegna, Sicilia, Toscana, Umbria and Veneto, i.e., 12 out of the 20 Italian regions) hint that reagent was a major bottleneck in expanding test capabilities, we expect this model to be able to increase the number of swabs tested even if it does not allow inter-regional swab reassignment, just by optimising reagent assignment. <xref rid="fig0005" ref-type="fig">Fig.&#x000a0;5</xref>
a shows how laboratories cluster within each region: an edge between two laboratories means that they belong to the same region.<fig id="fig0005"><label>Fig. 5</label><caption><p>Map of testing laboratories in Italy. An edge connects two laboratories if they can send swabs between each other overnight.</p></caption><alt-text id="at0005">Fig. 5</alt-text><graphic xlink:href="gr5_lrg"/></fig></p><p id="p0065">Finally, we consider the output obtained from the Hierarchical Model, but allowing for reallocation of swabs between laboratories in different regions. This assumption effectively means that regional daily demand can be shared across regions. Because swabs would need to move within a short time (e.g., overnight) we put limitations on the inter-laboratory distance that allows swab transfer. We consider three thresholds of 100Km, 200Km and 400Km and we denote the corresponding data as <bold>Model - 100Km, Model - 200Km</bold> and <bold>Model - 400Km</bold>. (We make an exception for the island region of Sardinia, for which moving swabs outside of the region would be unfeasible even if there are other laboratories within 400Km.) <xref rid="fig0005" ref-type="fig">Fig.&#x000a0;5</xref>b shows how laboratories can transfer swabs when using the 200Km threshold. Compare <xref rid="fig0005" ref-type="fig">Fig.&#x000a0;5</xref>a and b to note how inter-regional collaboration gives a central planner more opportunities to move swabs between regions in case there should be a day with a demand peak in a particular area. We refer the reader to <xref rid="bib0035" ref-type="bibr">[35]</xref> for the full description of the instance generation process and to <xref rid="bib0034" ref-type="bibr">[34]</xref> for an interactive dashboard presenting the results of the analysis.</p><p id="p0066">
<xref rid="fig0006" ref-type="fig">Fig.&#x000a0;6</xref>
shows the number of swabs tested, day-by-day, when using our proposed models <italic>Regional, 100Km, 200Km</italic>, and <italic>400Km</italic>. Note how <italic>Model - 400Km</italic> fully uses the system&#x02019;s capacity during the last period of the time horizon, where the number of tested swabs becomes a flat line. During some days, a model with fewer lab transfer capabilities gives more tested swabs than a model in which more transfers are allowed. For example, on April 6, using <italic>Model - 400Km</italic> results in fewer tests than <italic>Model - 200Km</italic> and <italic>Model - 100Km</italic>. This is not surprising if we consider that the models maximise the number of swabs tested over the whole planning horizon, even if this results in fewer tests on any particular day.<fig id="fig0006"><label>Fig. 6</label><caption><p>Number of swab tests performed on the national territory, per day. The dashed line reports official numbers from the Civil Defence agency. The other lines represent the results from applying the <italic>Hierarchical Model</italic> with intra-regional (orange column) and inter-regional (green, pink and blue lines) swab transfers. line inter-regional transfer radii considered are 100, 200 and 400Km. (For interpretation of the references to color in this figure legend, the reader is referred to the web version of this article.)</p></caption><alt-text id="at0006">Fig. 6</alt-text><graphic xlink:href="gr6_lrg"/></fig></p><p id="p0067">
<xref rid="tbl0001" ref-type="table">Table&#x000a0;1</xref>
reports detailed results of the analysis. Each row corresponds to one day, and the columns list the real data and the results obtained using the model. Columns <italic>#tests</italic> report the number of swabs tested during that day. Columns <italic>%gain</italic> are the percentage gains obtained using the models, compared to the number of swabs actually tested in Italy in the described period. The last row gives aggregate results for the whole country. Note how using optimisation techniques results in a testing capacity increase between 14% and 39%, under the hypotheses explained above. In particular, assuming that tests in Italy were largely limited by the unavailability of reagent due to a poor allocation of supplies and low inter-regional collaboration, optimising these two aspects can allow to perform up to 250&#x02009;000 more tests (the increase between <italic>Real Data</italic> and <italic>Model - 400Km</italic>) during 13 days.<table-wrap position="float" id="tbl0001"><label>Table 1</label><caption><p>Number of swabs tested on the national territory, day by day, from official real data and from the results obtained using our model. Columns <italic>#tests</italic> represent the number of swabs tested each day. Columns <italic>%gain</italic> are the percentage gains obtained using the model, compared to the real data.</p></caption><alt-text id="at0011">Table 1</alt-text><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top"/><th align="left" valign="top">Real Data</th><th colspan="2" align="left">Model - Regional<hr/></th><th colspan="2" align="left">Model - 100Km<hr/></th><th colspan="2" align="left">Model - 200Km<hr/></th><th colspan="2" align="left">Model - 400Km<hr/></th></tr><tr><th align="left" valign="top">Day of April</th><th align="left" valign="top">#tests</th><th align="left" valign="top">#tests</th><th align="left" valign="top">%gain</th><th align="left" valign="top">#tests</th><th align="left" valign="top">%gain</th><th align="left" valign="top">#tests</th><th align="left" valign="top">%gain</th><th align="left" valign="top">#tests</th><th align="left" valign="top">%gain</th></tr></thead><tbody><tr><td valign="top">1</td><td valign="top">34455</td><td valign="top">43202</td><td valign="top">25.39</td><td valign="top">47110</td><td valign="top">36.73</td><td valign="top">47110</td><td valign="top">36.73</td><td valign="top">47110</td><td valign="top">36.73</td></tr><tr><td valign="top">2</td><td valign="top">39809</td><td valign="top">46916</td><td valign="top">17.85</td><td valign="top">50674</td><td valign="top">27.29</td><td valign="top">50674</td><td valign="top">27.29</td><td valign="top">50674</td><td valign="top">27.29</td></tr><tr><td valign="top">3</td><td valign="top">38617</td><td valign="top">44567</td><td valign="top">15.41</td><td valign="top">53055</td><td valign="top">37.39</td><td valign="top">53055</td><td valign="top">37.39</td><td valign="top">53055</td><td valign="top">37.39</td></tr><tr><td valign="top">4</td><td valign="top">37375</td><td valign="top">44492</td><td valign="top">19.04</td><td valign="top">49190</td><td valign="top">31.61</td><td valign="top">49190</td><td valign="top">31.61</td><td valign="top">49190</td><td valign="top">31.61</td></tr><tr><td valign="top">5</td><td valign="top">34237</td><td valign="top">40463</td><td valign="top">18.19</td><td valign="top">44187</td><td valign="top">29.06</td><td valign="top">44187</td><td valign="top">29.06</td><td valign="top">44187</td><td valign="top">29.06</td></tr><tr><td valign="top">6</td><td valign="top">30271</td><td valign="top">42433</td><td valign="top">40.18</td><td valign="top">45835</td><td valign="top">51.42</td><td valign="top">45835</td><td valign="top">51.42</td><td valign="top">45835</td><td valign="top">51.42</td></tr><tr><td valign="top">7</td><td valign="top">33713</td><td valign="top">42414</td><td valign="top">25.81</td><td valign="top">47353</td><td valign="top">40.46</td><td valign="top">47353</td><td valign="top">40.46</td><td valign="top">47353</td><td valign="top">40.46</td></tr><tr><td valign="top">8</td><td valign="top">51680</td><td valign="top">55454</td><td valign="top">7.30</td><td valign="top">60163</td><td valign="top">16.41</td><td valign="top">60163</td><td valign="top">16.41</td><td valign="top">60163</td><td valign="top">16.41</td></tr><tr><td valign="top">9</td><td valign="top">46244</td><td valign="top">50207</td><td valign="top">8.57</td><td valign="top">53528</td><td valign="top">15.75</td><td valign="top">53528</td><td valign="top">15.75</td><td valign="top">53528</td><td valign="top">15.75</td></tr><tr><td valign="top">10</td><td valign="top">53495</td><td valign="top">55385</td><td valign="top">3.53</td><td valign="top">62666</td><td valign="top">17.14</td><td valign="top">62666</td><td valign="top">17.14</td><td valign="top">62666</td><td valign="top">17.14</td></tr><tr><td valign="top">11</td><td valign="top">56609</td><td valign="top">55332</td><td valign="top">-2.26</td><td valign="top">60536</td><td valign="top">6.94</td><td valign="top">60536</td><td valign="top">6.94</td><td valign="top">60536</td><td valign="top">6.94</td></tr><tr><td valign="top">12</td><td valign="top">46720</td><td valign="top">53292</td><td valign="top">14.07</td><td valign="top">56175</td><td valign="top">20.24</td><td valign="top">56175</td><td valign="top">20.24</td><td valign="top">56175</td><td valign="top">20.24</td></tr><tr><td valign="top">13</td><td valign="top">36717</td><td valign="top">43582</td><td valign="top">18.70</td><td valign="top">56287</td><td valign="top">53.30</td><td valign="top">56287</td><td valign="top">53.30</td><td valign="top">56287</td><td valign="top">53.30</td></tr><tr><td valign="top"><bold>Total</bold></td><td valign="top">539942</td><td valign="top">617739</td><td valign="top">14.41</td><td valign="top">686759</td><td valign="top">27.19</td><td valign="top">709996</td><td valign="top">31.49</td><td valign="top">750464</td><td valign="top">38.99</td></tr></tbody></table></table-wrap></p><p id="p0068">
<xref rid="fig0007" ref-type="fig">Fig.&#x000a0;7</xref>
shows example results from the <italic>Regional</italic> and <italic>400Km</italic> models, for four representative Italian regions from the north (Piemonte and Emilia-Romagna), the centre (Lazio) and the south (Sicilia) of the country. Each chart reports the number of swabs analysed per day. Note how, for three of the four regions, the results of the <italic>Regional</italic> model agree with the real data, validating our modelling assumptions and hinting that regions managed resources locally efficiently. In all four regions, during the last period of the planning horizon, the models use the full laboratory capacity and their curves appear flat, i.e., the limiting factor is not reagent availability anymore, but structural limitations such as testing machines or lab personnel. Note how, in Sicily during the middle period, the <italic>400Km</italic> model provides a solution with fewer tested swabs than the <italic>Regional</italic> model and the <italic>Real Data</italic>, for two days. However, there was a catch-up on the tests during the last part of the planning horizon, resulting in more tests carried out in total.<fig id="fig0007"><label>Fig. 7</label><caption><p>Number of swab tests performed in four Italian regions. The dashed line reports official numbers from the Civil Defence agency. The solid lines represents results obtained with our <italic>Hierarchical Model</italic> allowing intra-regional (orange line) and inter-regional (blue line) swab transfers. (For interpretation of the references to color in this figure legend, the reader is referred to the web version of this article.)</p></caption><alt-text id="at0007">Fig. 7</alt-text><graphic xlink:href="gr7_lrg"/></fig></p></sec><sec id="sec0012"><label>6.2</label><title>Synthetic data</title><p id="p0069">By conducting a scenario analysis on synthetic data, we want to learn how some aspects of the healthcare system of the area hit by an epidemic can affect its ability to perform large-scale testing of the population. The factors we analyse are:<list list-type="simple" id="lst0001"><list-item id="lstitem0009"><label>1.</label><p id="p0070">The effects of having a healthcare system with a large level of independent decision-making at the sub-national level (as is the case, e.g., of Italian regions, Spanish autonomous communities, German lander or the United States) and the benefits of increased cross-regional collaboration, common planning, and resource sharing.</p></list-item><list-item id="lstitem0010"><label>2.</label><p id="p0071">The capillarity and production capacity of bio-chemical and pharmaceutical industries able to prepare the reagent needed to carry out rRT-PCR tests, especially in light of the increasing trend to off-shore such manufacturing capabilities to developing countries (see, e.g., <xref rid="bib0021" ref-type="bibr">[21]</xref>, <xref rid="bib0042" ref-type="bibr">[42]</xref>).</p></list-item><list-item id="lstitem0011"><label>3.</label><p id="p0072">Reagent-independent laboratory capacity, i.e., the test capacity deriving by the number of available machines and personnel. This corresponds to the full laboratory capacity in the ideal case in which any amount of reagent were immediately available.</p></list-item><list-item id="lstitem0012"><label>4.</label><p id="p0073">The logistic capabilities of the country, i.e., how labs can procure reagent from manufacturing facilities and transfer swabs away from saturated labs.</p></list-item></list>
</p><sec id="sec0013"><label>6.2.1</label><title>Instance generation</title><p id="p0074">We list in the following the characteristics of the instances we generate. We consider <inline-formula><mml:math id="M64" altimg="si62.svg"><mml:mrow><mml:mo>|</mml:mo><mml:mi>L</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> laboratories, which we distribute in the square <inline-formula><mml:math id="M65" altimg="si63.svg"><mml:mrow><mml:mi>S</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>100</mml:mn><mml:mo>]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> in the euclidean plane as explained below. First, we define parameter <italic>&#x003bb;</italic>
<sub>L&#x000a0;&#x000d7;&#x000a0;R</sub>, which is the expected size of regions, i.e., the expected number of labs in each region. Next, we select <inline-formula><mml:math id="M66" altimg="si64.svg"><mml:mrow><mml:mi>n</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mo>&#x0230a;</mml:mo><mml:mo>|</mml:mo><mml:mi>L</mml:mi><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mrow><mml:mtext>L</mml:mtext><mml:mo>&#x000d7;</mml:mo><mml:mtext>R</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x0230b;</mml:mo></mml:mrow></mml:math></inline-formula> random points in [10, 90]<sup>2</sup> which we use as initial centroids for the regions (note how we excluded the external boundary of <italic>S</italic>). We place the labs in <italic>S</italic> by first choosing a random centroid and then a random point in <italic>S</italic> which lies at distance of at most 20 from the centroid, and repeating this procedure |<italic>L</italic>| times. In this way, we aim at placing clusters in loose regional clusters. To complete the assignment of labs to regions, we assign each lab to its closest centroid.</p><p id="p0075">Another parameter, <italic>&#x003bb;</italic>
<sub>F&#x000a0;&#x000d7;&#x000a0;R</sub>, determines how distributed is the country&#x02019;s reagent production capacity; this parameters represents the expected number of reagent factories per region. We place <inline-formula><mml:math id="M67" altimg="si65.svg"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>R</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>n</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mrow><mml:mtext>F</mml:mtext><mml:mo>&#x000d7;</mml:mo><mml:mtext>R</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> factories at random in <italic>S</italic>. <xref rid="fig0008" ref-type="fig">Fig.&#x000a0;8</xref>
a shows an example distribution of labs and factories. Dots represent laboratories, stars denote factories, and lines are the Voronoi boundaries (see, e.g., <xref rid="bib0031" ref-type="bibr">[31, Ch.&#x000a0;5]</xref>) associated with regional centroids (i.e., the lines delimit the regions).<fig id="fig0008"><label>Fig. 8</label><caption><p>Example of a synthetic instance with <italic>bumpy</italic> reagent production at factories.</p></caption><alt-text id="at0008">Fig. 8</alt-text><graphic xlink:href="gr8_lrg"/></fig></p><p id="p0076">To determine the demand of each region, we assume that 40% of the regions will have a criticality, such as a focus of the illness, and will thus require more tests. (For example, during the COVID-19 pandemics, the Chinese province of Wuhan, northern Italian regions, the autonomous communities of La Rioja, Madrid and Castilla-La Mancha in Spain, or the states of Washington and New York in the U.S.A.&#x000a0;were foci in their respective countries.) The other regions might, instead, have some spare capacity which they can use, if resources are properly coordinated, to help saturated regions. Let <inline-formula><mml:math id="M68" altimg="si66.svg"><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> be an ideal number of tests to perform per lab per day (assuming ideal conditions), and let |<italic>L<sub>i</sub></italic>| be the number of labs in region <italic>i</italic>. The number of tests requested in region <italic>i</italic> on day <italic>t</italic> is<disp-formula id="ueq0001"><mml:math id="M69" altimg="si67.svg"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mn>2</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mi>&#x003b5;</mml:mi></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="4.pt"/><mml:mtext>for</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>40%</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>randomly</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>chosen</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>regions</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mn>0.75</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mi>&#x003b5;</mml:mi></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="4.pt"/><mml:mtext>for</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>the</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>remaining</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>60%</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>of</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>regions,</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula> where &#x003b5; is a noise term distributed according to a truncated normal distribution between 0.95 and 1.05. The definition of <italic>m<sub>it</sub></italic> is justified by the assumption that the number of swabs to test depends on regional population, which correlates positively with the number of laboratories in the region. The dot size in <xref rid="fig0008" ref-type="fig">Fig.&#x000a0;8</xref>a is directly proportional to the lab&#x02019;s region average demand in the example instance; note how two bordering regions are &#x0201c;critical&#x0201d;.</p><p id="p0077">Lab capacities are then defined as a fraction of the ideal number of tests assigned to each lab: <inline-formula><mml:math id="M70" altimg="si68.svg"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mtext>LC</mml:mtext></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> where <italic>&#x003bb;</italic>
<sub>LC</sub> is a parameter. Values of the parameter larger than 1 correspond to a situation in which reagent availability is the main bottleneck for testing, while smaller values indicate that laboratories have structural deficiencies which limit the number of swabs they can test, even when reagent is abundant. Each lab can procure reagent from its <italic>&#x003bb;</italic>
<sub>LF</sub> closest factories, and can send swabs to other laboratories in the same region. A parameter <italic>&#x003bb;</italic>
<sub>LL</sub> gives the maximum distance at which two labs in different regions can exchange swabs. In particular, when <inline-formula><mml:math id="M71" altimg="si69.svg"><mml:mrow><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mtext>LL</mml:mtext></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> we forbid cross-regional collaboration and sharing of testing capacity.</p><p id="p0078">Regional inbound capacities for reagent (<inline-formula><mml:math id="M72" altimg="si47.svg"><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mtext>rg</mml:mtext></mml:msubsup></mml:math></inline-formula>) and for swabs (<inline-formula><mml:math id="M73" altimg="si48.svg"><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mtext>sw</mml:mtext></mml:msubsup></mml:math></inline-formula>) are determined as:<disp-formula id="ueq0002"><mml:math id="M74" altimg="si70.svg"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mtext>rg</mml:mtext></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>for</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>80%</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>of</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>the</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>regions</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mn>0.75</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>for</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>20%</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>&#x0201c;impervious&#x0201d;</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>regions</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mtext>sw</mml:mtext></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>for</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>80%</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>of</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>the</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>regions</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mn>0.10</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>for</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>20%</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>&#x0201c;impervious&#x0201d;</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>regions,</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p><p id="p0079">We assume here that the &#x0201c;impervious&#x0201d; regions have tighter logistical constraints; for example, islands, mountainous areas, or regions with poorer infrastructure. We set the initial amount of reagent stored at labs and factories to a minimal amount, as follows:<disp-formula id="ueq0003"><mml:math id="M75" altimg="si71.svg"><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mi>&#x003b5;</mml:mi></mml:mrow><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>&#x000b7;</mml:mo><mml:mfrac><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mrow><mml:mtext>L</mml:mtext><mml:mo>&#x000d7;</mml:mo><mml:mtext>R</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mrow><mml:mtext>F</mml:mtext><mml:mo>&#x000d7;</mml:mo><mml:mtext>R</mml:mtext></mml:mrow></mml:msub></mml:mfrac><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mi>&#x003b5;</mml:mi></mml:mrow><mml:mtext>,</mml:mtext></mml:mrow></mml:math></disp-formula> where &#x003b5; is distributed according to a truncated normal distribution between 0 and 0.25. Such a choice corresponds to labs and factories having a small fraction of their daily, respectively needed and produced, reagent in the initial stock &#x02014; a situation that can commonly occur during an epidemic, when safety stocks are quickly depleted.</p><p id="p0080">Next, we describe how we determine factories&#x02019; daily production. We propose two production patterns (selected via parameter <italic>&#x003bb;</italic>
<sub>PP</sub>): steady and bumpy. Under the steady pattern, each factory <italic>r</italic> produces <inline-formula><mml:math id="M76" altimg="si72.svg"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>&#x000b7;</mml:mo><mml:mfrac><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mrow><mml:mtext>L</mml:mtext><mml:mo>&#x000d7;</mml:mo><mml:mtext>R</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mrow><mml:mtext>F</mml:mtext><mml:mo>&#x000d7;</mml:mo><mml:mtext>R</mml:mtext></mml:mrow></mml:msub></mml:mfrac><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mtext>FP</mml:mtext></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mi>&#x003b5;</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> units of reagent each day, where &#x003b5; follows a truncated normal distribution between 0.95 and 1.05 and <italic>&#x003bb;</italic>
<sub>FP</sub> is a parameter. Note how <italic>&#x003bb;</italic>
<sub>FP</sub>&#x000a0;&#x0003c;&#x000a0;1 drives the total factory production capacity to be smaller than the total demand, indicating a situation in which there is less reagent than the nation needs. Values of <italic>&#x003bb;</italic>
<sub>FP</sub>&#x000a0;&#x02265;&#x000a0;1 drive the total reagent production towards meeting the demand; in this case, tests not performed because of lack of reagent are more likely due to poor resource allocation over the national territory, rather than an absolute scarcity of reagent. Under the bumpy pattern, for each factory we first choose two random days of the week <inline-formula><mml:math id="M77" altimg="si73.svg"><mml:mrow><mml:msubsup><mml:mi>&#x003c4;</mml:mi><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003c4;</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> which we call &#x0201c;release days&#x0201d;. The factory will produce reagent at the same rate as under the steady pattern, but will not make them available until the current day <italic>t</italic> corresponds to one of the two <inline-formula><mml:math id="M78" altimg="si74.svg"><mml:mrow><mml:msubsup><mml:mi>&#x003c4;</mml:mi><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003c4;</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> (i.e., <inline-formula><mml:math id="M79" altimg="si75.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="4.pt"/><mml:mtext>mod</mml:mtext><mml:mspace width="4.pt"/><mml:msubsup><mml:mi>&#x003c4;</mml:mi><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="M80" altimg="si76.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="4.pt"/><mml:mtext>mod</mml:mtext><mml:mspace width="4.pt"/><mml:msubsup><mml:mi>&#x003c4;</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>). At that point, it is ready to ship all the reagent produced since the last release day. This second pattern simulates a situation in which it is infeasible, due to logistic constraints, to have daily shipments out of the factories. <xref rid="fig0008" ref-type="fig">Fig.&#x000a0;8</xref>b shows an example of bumpy production. The coloured bars correspond to the quantities released by the factories on their release days, while grey background bars count the total amount of reagent released on that day, by all factories. The figure shows that, even if factories have, in principle, a steady production rate (only fluctuating between <inline-formula><mml:math id="M81" altimg="si77.svg"><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>% and <inline-formula><mml:math id="M82" altimg="si78.svg"><mml:mrow><mml:mo>+</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>% due to the noise term &#x003b5;), making new reagent available twice per week produces an uneven total daily distribution.</p><p id="p0081">Last, we introduce transshipment parameter <italic>&#x003bb;</italic>
<sub>TS</sub>, which takes values yes or no. This parameter does not affect instance generation; rather, it enables or disables the transshipment of reagent between laboratories in the model. If transshipments are not allowed, it forces all variables <inline-formula><mml:math id="M83" altimg="si79.svg"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to take value zero.</p><p id="p0082">
<xref rid="tbl0002" ref-type="table">Table&#x000a0;2</xref>
summarises all instance generation parameters we used. Because in our scenario analysis we vary each parameter independently, we ran the Hierarchical Model over the full grid of 60&#x02009;480 instances. We ran the model twice for each instance, once enabling and once disabling transshipments.<table-wrap position="float" id="tbl0002"><label>Table 2</label><caption><p>Synthetic instance generation parameters.</p></caption><alt-text id="at0012">Table 2</alt-text><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top">Parameter</th><th align="left" valign="top">Description</th><th align="left" valign="top">Num values</th><th align="left" valign="top">Values</th></tr></thead><tbody><tr><td valign="top">|<italic>T</italic>|</td><td valign="top">Time horizon length</td><td valign="top">4</td><td valign="top">5, 7, 10, 14</td></tr><tr><td valign="top"><italic>&#x003bb;</italic><sub>L&#x000a0;&#x000d7;&#x000a0;R</sub></td><td valign="top">Labs per region</td><td valign="top">3</td><td valign="top">5, 10, 20</td></tr><tr><td valign="top"><italic>&#x003bb;</italic><sub>F&#x000a0;&#x000d7;&#x000a0;R</sub></td><td valign="top">Factories per region</td><td valign="top">4</td><td valign="top">0.1, 0.25, 0.5, 1</td></tr><tr><td valign="top"><italic>&#x003bb;</italic><sub>LC</sub></td><td valign="top">Lab capacity multiplier</td><td valign="top">7</td><td valign="top">0.5, 0.7, 0.9, 1, 1.1, 1.3, 1.5</td></tr><tr><td valign="top"><italic>&#x003bb;</italic><sub>LF</sub></td><td valign="top">Number of factories supplying each lab</td><td valign="top">3</td><td valign="top">1, 2, 3</td></tr><tr><td valign="top"><italic>&#x003bb;</italic><sub>LL</sub></td><td valign="top">Radius for inter-regional swab transfers</td><td valign="top">6</td><td valign="top">0, 5, 10, 15, 20, 25</td></tr><tr><td valign="top"><italic>&#x003bb;</italic><sub>FP</sub></td><td valign="top">Factory production multiplier</td><td valign="top">5</td><td valign="top">0.8, 0.9, 1, 1.1, 1.2</td></tr><tr><td valign="top"><italic>&#x003bb;</italic><sub>PP</sub></td><td valign="top">Factory production pattern</td><td valign="top">2</td><td valign="top">steady, bumpy</td></tr><tr><td valign="top"><italic>&#x003bb;</italic><sub>TS</sub></td><td valign="top">Transshipments</td><td valign="top">2</td><td valign="top">yes, no</td></tr></tbody></table></table-wrap></p></sec><sec id="sec0014"><label>6.2.2</label><title>Scenario analysis</title><p id="p0083">We report the results of our scenario analysis, highlighting how the parameters affect the testing capacity and commenting on which real-life decisions a planner can take to increase the number of swabs tested. A better testing capacity depends on both structural factors (such as a strong reagent industrial base) which require long-term decisions, and organisational factors (such as more inter-regional collaboration) which are influenced by operational decisions.</p><p id="p0084">
<xref rid="fig0009" ref-type="fig">Fig.&#x000a0;9</xref>
shows the percentage of swabs tested within the end of the time horizon, over all the swabs collected and available for testing. In other words, if the planner manages to allocate swabs to laboratories in such a way that all swabs are tested within the considered time horizon, then this percentage would be 100%. Each chart corresponds to one parameter; we use line charts for the seven numeric parameters, and box plots for <italic>&#x003bb;</italic>
<sub>PP</sub> and <italic>&#x003bb;</italic>
<sub>TS</sub>, which are categorical. In each chart, the <italic>x</italic> axis reports the value taken by the parameter. The <italic>y</italic> axis reports the percentage of swabs tested when solving instances generated with the corresponding parameter. For the line charts, the solid line denotes the average percentage of swabs tested over all instances generated with the given parameter value, while the shaded area is the 95% confidence interval obtained via bootstrapping (using 1000 iterations). For the box plots, each box denotes the two central quartiles, the horizontal line is the median, and whiskers extend to the rest of the distribution.<fig id="fig0009"><label>Fig. 9</label><caption><p>Variation in the percentage of swabs tested (<italic>y</italic> axis), when varying each parameter (<italic>x</italic> axis). In each chart, the line shows the average over all instances generated with the given parameter value and the shaded area around the line is the 95% confidence interval. For parameters <italic>&#x003bb;</italic><sub>PP</sub> and <italic>&#x003bb;</italic><sub>TS</sub>, as they take categorical values, we show a box plot instead of a line plot. The central line indicates the median, the box spans the two central quartiles, while whiskers extend to the rest of the distribution (excluding outliers).</p></caption><alt-text id="at0009">Fig. 9</alt-text><graphic xlink:href="gr9_lrg"/></fig></p><p id="p0085">Two linear regression analyses provide additional findings. They use the instance parameters as independent variables. We centre and standardise numeric parameters, and transform <italic>&#x003bb;</italic>
<sub>PP</sub> and <italic>&#x003bb;</italic>
<sub>TS</sub> into numeric parameters, respectively, with value 0 if the production was steady and 1 if bumpy, and 0 when transshipments are not allowed and 1 when they are. The percentage of swabs tested and the average time a swab spent in a lab waiting to be tested are, respectively, the dependent variables in the two analyses. <xref rid="tbl0003" ref-type="table">Table&#x000a0;3</xref>
reports the results, while in the following we comment on the insights obtained.<table-wrap position="float" id="tbl0003"><label>Table 3</label><caption><p>Results of a linear regression analysis using the parameters as independent variables and the primary (number of swabs tested, expressed as a percentage of the total demand) and secondary (average waiting time of a swab before it is tested) objectives as dependent variables. Columns <italic>coef</italic> report the linear regression coefficients, after centring and standardising the inputs. All independent variables resulted significant, with <italic>p</italic>-values always smaller than 0.001.</p></caption><alt-text id="at0013">Table 3</alt-text><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top"/><th colspan="2" align="left">% swabs tested<hr/></th><th colspan="2" align="left">swab wait time<hr/></th></tr><tr><th align="left" valign="top">ind.&#x000a0;variable</th><th align="left" valign="top">coef</th><th align="left" valign="top"><bold><italic>p</italic></bold>-value</th><th align="left" valign="top">coef</th><th align="left" valign="top"><bold><italic>p</italic></bold>-value</th></tr></thead><tbody><tr><td valign="top">intercept</td><td valign="top">42.98</td><td valign="top"><inline-formula><mml:math id="M84" altimg="si4.svg"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td valign="top">0.36</td><td valign="top"><inline-formula><mml:math id="M85" altimg="si4.svg"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td></tr><tr><td valign="top">|<italic>T</italic>|</td><td valign="top">0.64</td><td valign="top"><inline-formula><mml:math id="M86" altimg="si4.svg"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td valign="top">&#x02212;0.13</td><td valign="top"><inline-formula><mml:math id="M87" altimg="si4.svg"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td></tr><tr><td valign="top"><italic>&#x003bb;</italic><sub>L&#x000a0;&#x000d7;&#x000a0;R</sub></td><td valign="top">&#x02212;0.94</td><td valign="top"><inline-formula><mml:math id="M88" altimg="si4.svg"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td valign="top">0.00</td><td valign="top">0.19</td></tr><tr><td valign="top"><italic>&#x003bb;</italic><sub>F&#x000a0;&#x000d7;&#x000a0;R</sub></td><td valign="top">3.65</td><td valign="top"><inline-formula><mml:math id="M89" altimg="si4.svg"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td valign="top">0.06</td><td valign="top"><inline-formula><mml:math id="M90" altimg="si4.svg"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td></tr><tr><td valign="top"><italic>&#x003bb;</italic><sub>LC</sub></td><td valign="top">5.26</td><td valign="top"><inline-formula><mml:math id="M91" altimg="si4.svg"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td valign="top">0.10</td><td valign="top"><inline-formula><mml:math id="M92" altimg="si4.svg"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td></tr><tr><td valign="top"><italic>&#x003bb;</italic><sub>LF</sub></td><td valign="top">3.00</td><td valign="top"><inline-formula><mml:math id="M93" altimg="si4.svg"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td valign="top">0.04</td><td valign="top"><inline-formula><mml:math id="M94" altimg="si4.svg"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td></tr><tr><td valign="top"><italic>&#x003bb;</italic><sub>LL</sub></td><td valign="top">0.50</td><td valign="top"><inline-formula><mml:math id="M95" altimg="si4.svg"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td valign="top">0.02</td><td valign="top"><inline-formula><mml:math id="M96" altimg="si4.svg"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td></tr><tr><td valign="top"><italic>&#x003bb;</italic><sub>FP</sub></td><td valign="top">0.63</td><td valign="top"><inline-formula><mml:math id="M97" altimg="si4.svg"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td valign="top">0.01</td><td valign="top"><inline-formula><mml:math id="M98" altimg="si4.svg"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td></tr><tr><td valign="top"><italic>&#x003bb;</italic><sub>PP</sub></td><td valign="top">&#x02212;12.86</td><td valign="top"><inline-formula><mml:math id="M99" altimg="si4.svg"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td valign="top">&#x02212;0.20</td><td valign="top"><inline-formula><mml:math id="M100" altimg="si4.svg"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td></tr><tr><td valign="top"><italic>&#x003bb;</italic><sub>TS</sub></td><td valign="top">1.21</td><td valign="top"><inline-formula><mml:math id="M101" altimg="si4.svg"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td valign="top">0.02</td><td valign="top"><inline-formula><mml:math id="M102" altimg="si4.svg"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td></tr></tbody></table></table-wrap></p><p id="p0086">
<bold>Steadiness of reagent supply.</bold> Parameter <italic>&#x003bb;</italic>
<sub>PP</sub> is the one with the largest impact in our analysis: a steady availability of reagent allows the laboratories to operate without interruptions, testing more swabs and with shorter delays. The average percentage of swabs tested when <inline-formula><mml:math id="M103" altimg="si80.svg"><mml:mrow><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mtext>PP</mml:mtext></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mtext>steady</mml:mtext></mml:mrow></mml:math></inline-formula> is double than when <inline-formula><mml:math id="M104" altimg="si81.svg"><mml:mrow><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mtext>PP</mml:mtext></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mtext>bumpy</mml:mtext></mml:mrow></mml:math></inline-formula>. Recall that a factory in our model can represent a real production site, but also a warehouse or a shipment from abroad. A physical factory will be able to maintain a steadier production rate, while relying on shipments will resemble more the &#x0201c;bumpy&#x0201d; scenario. The analysis, thus, hints to the fact that a solid industrial sector and a well-function supply chain can have the greatest impact on testing capacity; not necessarily because they allow to procure more reagent in total, but because they provide a steadier flow of it. A country that cannot count on such production capacity can mitigate the adverse effects of irregular supply with larger orders (see the positive impact of parameter <italic>&#x003bb;</italic>
<sub>FP</sub>), more inventory capacity and a quick dispatch of reagent to labs.</p><p id="p0087">
<bold>Capillarity of the reagent industry.</bold> Having more small reagent production sites works better than having few, larger ones (parameter <italic>&#x003bb;</italic>
<sub>F&#x000a0;&#x000d7;&#x000a0;R</sub>). When <italic>&#x003bb;</italic>
<sub>F&#x000a0;&#x000d7;&#x000a0;R</sub> moves from 0.1 to 1.0, the average percentage of swabs tested climbs from 40.83% to 51.46%. An efficient supply chain which is able to move material over longer distances (parameter <italic>&#x003bb;</italic>
<sub>LF</sub>) also has a positive impact on testing capacity. When each lab can procure from its closest factory (<inline-formula><mml:math id="M105" altimg="si82.svg"><mml:mrow><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mtext>LF</mml:mtext></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>), the analysis shows that 41.36% of swabs are tested. This number increases to 47.86% and then to 49.61%, when <italic>&#x003bb;</italic>
<sub>LF</sub> increases to, respectively, 2 and 3.</p><p id="p0088">
<bold>Lab capacity and inter-regional capacity sharing.</bold> Other two factors which impact the amount of swabs tested are lab capacity and the degree to which regions can share this capacity by transferring swabs between each other. Parameter <italic>&#x003bb;</italic>
<sub>LC</sub> clearly influences testing capabilities: for <italic>&#x003bb;</italic>
<sub>LC</sub>&#x000a0;&#x0003c;&#x000a0;1 largely less than half of the swabs are tested within the end of the time horizon. When <italic>&#x003bb;</italic>
<sub>LC</sub>&#x000a0;&#x02265;&#x000a0;1, i.e., when the total lab capacity is at least as large as the average demand, gains are marginal, as exhibited by the curve flattening in <xref rid="fig0009" ref-type="fig">Fig.&#x000a0;9</xref>. It is at this point that we would expect capacity sharing via increased inter-regional collaboration to have the greatest effect. The extent at which capacity is shared depends on parameter <italic>&#x003bb;</italic>
<sub>LL</sub>. It might appear, looking at <xref rid="fig0009" ref-type="fig">Fig.&#x000a0;9</xref>, that the impact of <italic>&#x003bb;</italic>
<sub>LL</sub> is small. However, if we divide the analysis of its impact between instances with <italic>&#x003bb;</italic>
<sub>LC</sub>&#x000a0;&#x0003c;&#x000a0;1 and instances with <italic>&#x003bb;</italic>
<sub>LC</sub>&#x000a0;&#x02265;&#x000a0;1, the situation is different, as reported in <xref rid="fig0010" ref-type="fig">Fig.&#x000a0;10</xref>
. Note how the curve referring to instances with <italic>&#x003bb;</italic>
<sub>LC</sub>&#x000a0;&#x02265;&#x000a0;1 is much steeper, corresponding to a larger percentage increase in swabs tested. We can conclude that countries with insufficient lab infrastructures should primarily focus on procuring test machinery and training personnel to carry out rRT-PCR tests. Countries which already have a developed test lab network, on the other hand, benefit more from inter-regional collaboration and centralised planning than they do from increasing lab capacity.<fig id="fig0010"><label>Fig. 10</label><caption><p>Variation in the percentage of swabs tested (<italic>y</italic> axis), when varying parameter <italic>&#x003bb;</italic><sub>LL</sub> (<italic>x</italic> axis). The chart on the left refers to instances with <italic>&#x003bb;</italic><sub>LC</sub>&#x000a0;&#x0003c;&#x000a0;1, while that on the right, to instances with <italic>&#x003bb;</italic><sub>LC</sub>&#x000a0;&#x02265;&#x000a0;1.</p></caption><alt-text id="at0010">Fig. 10</alt-text><graphic xlink:href="gr10_lrg"/></fig></p><p id="p0089">
<bold>Other factors.</bold> Allowing transshipments produces an increase in swabs tested, from 43.30% to 45.85% on average (an increase of <inline-formula><mml:math id="M106" altimg="si83.svg"><mml:mrow><mml:mo>+</mml:mo><mml:mn>5.03</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>), placing parameter <italic>&#x003bb;</italic>
<sub>TS</sub>&#x02019;s impact behind several others. We suspect that the reason is that there are few cases in which moving reagent in one direction gives different results compared to moving swabs in the opposite direction, as mentioned in <xref rid="sec0008" ref-type="sec">Section&#x000a0;5.2</xref>. Transshipments&#x02019; effect is larger if we focus on instances with bumpy reagent production. In this case they increase the number of swabs tested by <inline-formula><mml:math id="M107" altimg="si84.svg"><mml:mrow><mml:mo>+</mml:mo><mml:mn>11.14</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>. This result suggests that transshipments can smooth irregular production patterns: a country which cannot procure reagent steadily should increase internal collaboration by moving both swabs and reagent. The percentage of swabs tested decreases when there are fewer, larger regions (parameter <italic>&#x003bb;</italic>
<sub>L&#x000a0;&#x000d7;&#x000a0;R</sub>). This is because, with fewer regions, the impact of one region being critical, i.e., with larger demands <italic>m<sub>it</sub></italic>, is proportionally larger. The effect of region size is rather modest, as indicated by a small regression coefficient associated with <italic>&#x003bb;</italic>
<sub>L&#x000a0;&#x000d7;&#x000a0;R</sub>. Regarding the planning horizon length |<italic>T</italic>|, its impact is unclear. On one hand, a longer time horizon allows more opportunities for optimisation. On the other hand, there is a reduction in tested swabs when moving from <inline-formula><mml:math id="M108" altimg="si85.svg"><mml:mrow><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="M109" altimg="si86.svg"><mml:mrow><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mn>7</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> which is hard to explain. In practice, a planner would want to balance the advantages usually conferred by longer-term planning with the quality of the demand predictions that he can obtain from epidemiological models. Finally, while the signs of the regression coefficients in the two regression analyses tend to coincide (meaning that parameters which have a positive impact on the number of swabs tested also have a positive impact on shortening wait times), the signs disagree for parameters <italic>&#x003bb;</italic>
<sub>L&#x000a0;&#x000d7;&#x000a0;R</sub> and |<italic>T</italic>|, making it difficult to derive actionable recommendations for decision makers based on these two parameters.</p><p id="p0090">To summarise the impact of resource sharing, <xref rid="tbl0004" ref-type="table">Table&#x000a0;4</xref>
shows how the quantity of swabs tested changes depending on the quantity of swabs moved. Indicator &#x0201c;% swabs moved&#x0201d; is the percentage of swabs sent from one lab to another, over the total number of swabs collected. The table shows the correlation between swabs sharing and the effectiveness of the test campaign, independently from how swab sharing was achieved. In our simulations swab sharing depends on instance generation parameters, but in real life it can depend on actions taken by the planner.<table-wrap position="float" id="tbl0004"><label>Table 4</label><caption><p>Relation between the percentage of swabs moved between laboratories (column &#x0201c;% swabs moved&#x0201d;) over all swabs collected, and the success of the testing campaign as indicated by the percentage of swabs tested over all swabs collected (column &#x0201c;avg % swabs tested&#x0201d;). The second column contains averages over all values of the first column belonging to each interval.</p></caption><alt-text id="at0014">Table 4</alt-text><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top">% swabs moved</th><th align="left" valign="top">avg % swabs tested</th></tr></thead><tbody><tr><td valign="top">[0, 5]</td><td valign="top">38.38</td></tr><tr><td valign="top">(5, 10]</td><td valign="top">36.24</td></tr><tr><td valign="top">(10, 15]</td><td valign="top">43.34</td></tr><tr><td valign="top">(15, 20]</td><td valign="top">56.59</td></tr><tr><td valign="top">(20, 25]</td><td valign="top">67.34</td></tr><tr><td valign="top">(25, 30]</td><td valign="top">64.72</td></tr><tr><td valign="top">(30, 35]</td><td valign="top">84.97</td></tr></tbody></table></table-wrap></p></sec></sec></sec><sec id="sec0015"><label>7</label><title>Conclusions</title><p id="p0091">We have proposed a model for the problem of assigning reagent and swabs to laboratories in a country which wants to maximise the number of rRT-PCR tests during a viral epidemic. After describing an Integer Programming model for a basic version of the problem, we have strengthened and extended the formulation to include real-life aspects of the organisation of healthcare systems. The complete model takes into account that many countries manage healthcare at a regional level and that labs can function as reagent transshipment points, and allows to optimise two hierarchical objectives: primarily, maximising the number of tests performed and, secondarily, minimising the average time a swab waits before it is tested.</p><p id="p0092">We performed two computational studies: the first based on real-life data from Italy and the second on synthetic instances. Under the assumptions we used, the main one being that reagent availability is often a bottleneck for testing more swabs (see, e.g., <xref rid="bib0001" ref-type="bibr">[1]</xref>, <xref rid="bib0013" ref-type="bibr">[13]</xref>, <xref rid="bib0043" ref-type="bibr">[43]</xref>), the analysis has revealed two main findings:<list list-type="simple" id="lst0004"><list-item id="lstitem0013"><label>&#x02022;</label><p id="p0093">Increased inter-regional coordination has the potential of increasing the testing capabilities of the country as a whole, as shown by the analysis of Italian data. In particular, moving swabs from critical regions to regions with spare capacity produced an increase of up to 40% in the number of swabs tested in the Italian scenario. The study performed on synthetic data confirmed this finding, but found a more modest effect. The recommendation, in fact, is that countries which do not have adequate lab infrastructure (i.e., which would have insufficient test capacity even if fully stocked with reagent) first focus on expanding their lab network, e.g., by purchasing new machines and training more lab personnel. Countries with an advanced laboratory infrastructure, instead, will benefit more from inter-regional collaboration.</p></list-item><list-item id="lstitem0014"><label>&#x02022;</label><p id="p0094">Steady availability of reagent has a large impact on the number of swabs tested and their waiting time. A solid chemical industrial base, with many (although possibly small) factories producing reagent daily gives an advantage compared with having to rely on a discontinuous supply, e.g., when purchasing from international markets. If the supply is not steady, then we recommend to allow labs to work as small warehouses by letting them forward reagent to other labs, i.e., enabling transshipments.</p></list-item></list>
</p><p id="p0095">On the short term, increasing inter-regional collaboration requires political will and an efficient supply chain which can be used to move swabs and reagent. On the other hand, increasing reagent production capacity involves longer-term investments and balancing the economic interests of pharmaceutical companies with national interests.</p><p id="p0096">Future research on optimising the delivery of mass-scale test programmes can develop integrating other test types, such as immunological tests, i.e., tests which detect the presence of antibodies which a person has developed in response to the viral infection. These tests are too slow for early detection of positive patients; e.g., T and B cells response to COVID-19 were detected around one week after the onset of symptoms <xref rid="bib0039" ref-type="bibr">[39]</xref>, while swab tests can identify the virus even before symptoms appear. However, because antibodies persist in the blood even after a patient does not host the virus any longer, health authorities use immunological tests for mass-screening of populations (including asymptomatic patients) with the aim of assessing the prevalence of the virus, the level of population immunity and other epidemiological dynamics. It would be interesting to study not only how to increase capacity for immunological tests, but also to study the problem of selecting the patients to test with higher priority, in order to create an accurate epidemiological picture of the population while using a restricted supply of antibody tests such as ELISA (enzyme-linked immunosorbent assay) <xref rid="bib0041" ref-type="bibr">[41]</xref> or neutralization assays <xref rid="bib0045" ref-type="bibr">[45]</xref>.</p></sec><sec id="sec0017"><title>Funding</title><p id="p0097">The author was partially supported by grant &#x0201c;RTI2018-095197-B-I00&#x0201d; from the Spanish Ministry of Economy and Competitiveness.</p></sec><sec id="sec0017a"><title>CRediT authorship contribution statement</title><p id="p0097a">
<bold>Alberto Santini:</bold> Conceptualization, Data curation, Formal analysis, Funding acquisition, Investigation, Methodology, Project administration, Resources, Software, Supervision, Validation, Visualization, Writing - original draft, Writing - review &#x00026; editing.</p></sec><sec sec-type="COI-statement"><title>Declaration of Competing Interest</title><p id="p0098">None.</p></sec></body><back><ref-list id="bib001"><title>References</title><ref id="bib0001"><label>1</label><element-citation publication-type="book" id="sbref0001"><person-group person-group-type="author"><name><surname>Baird</surname><given-names>R.</given-names></name></person-group><chapter-title>Why widespread coronavirus testing isn&#x02019;t coming anytime soon</chapter-title><year>2020</year><publisher-name>The New Yorker</publisher-name></element-citation><note><p><ext-link ext-link-type="uri" xlink:href="https://www.newyorker.com/news/news-desk/why-widespread-coronavirustesting-isnt-coming-anytime-soon" id="intrrf0001">https://www.newyorker.com/news/news-desk/why-widespread-coronavirustesting-isnt-coming-anytime-soon</ext-link></p></note></ref><ref id="bib0002"><label>2</label><element-citation publication-type="journal" id="sbref0002"><person-group person-group-type="author"><name><surname>Banasik</surname><given-names>A.</given-names></name><name><surname>Kanellopoulos</surname><given-names>A.</given-names></name><name><surname>Claassen</surname><given-names>F.</given-names></name><name><surname>Bloemhof-Ruwaard</surname><given-names>J.</given-names></name><name><surname>van der Vorst</surname><given-names>J.</given-names></name></person-group><article-title>Assessing alternative production options for eco-efficient food supply chains using multi-objective optimization</article-title><source>Ann Oper Res</source><volume>250</volume><issue>2</issue><year>2017</year><fpage>341</fpage><lpage>362</lpage><pub-id pub-id-type="doi">10.1007/s10479-016-2199-z</pub-id></element-citation></ref><ref id="bib0003"><label>3</label><element-citation publication-type="journal" id="sbref0003"><person-group person-group-type="author"><name><surname>Bonami</surname><given-names>P.</given-names></name><name><surname>Lodi</surname><given-names>A.</given-names></name><name><surname>Tramontani</surname><given-names>A.</given-names></name><name><surname>Wiese</surname><given-names>S.</given-names></name></person-group><article-title>On mathematical programming with indicator constraints</article-title><source>Math Program</source><volume>151</volume><year>2015</year><fpage>191</fpage><lpage>223</lpage><pub-id pub-id-type="doi">10.1007/s10107-015-0891-4</pub-id></element-citation></ref><ref id="bib0004"><label>4</label><element-citation publication-type="journal" id="sbref0004"><person-group person-group-type="author"><name><surname>Bustin</surname><given-names>S.</given-names></name></person-group><article-title>Quantification of mRNA using real-time reverse transcription PCR (RT-PCR): trends and problems</article-title><source>J Mol Endocrinol</source><volume>29</volume><year>2002</year><fpage>23</fpage><lpage>39</lpage><pub-id pub-id-type="doi">10.1677/jme.0.0290023</pub-id><pub-id pub-id-type="pmid">12200227</pub-id></element-citation></ref><ref id="bib0005"><label>5</label><element-citation publication-type="journal" id="sbref0005"><person-group person-group-type="author"><name><surname>Cao</surname><given-names>H.</given-names></name><name><surname>Huang</surname><given-names>S.</given-names></name></person-group><article-title>Principles of scarce medical resource allocation in natural disaster relief: a simulation approach</article-title><source>Med Decis Making</source><volume>32</volume><issue>3</issue><year>2012</year><fpage>470</fpage><lpage>476</lpage><pub-id pub-id-type="doi">10.1177/0272989X12437247</pub-id><pub-id pub-id-type="pmid">22367795</pub-id></element-citation></ref><ref id="bib0006"><label>6</label><element-citation publication-type="book" id="sbref0006"><person-group person-group-type="author"><name><surname>Center for Disease Control and Prevention</surname></name></person-group><chapter-title>CDC 2019-Novel coronavirus (2019-nCoV) real-time RT-PCR diagnostic panel</chapter-title><source>Technical Report CDC-006-00019, Revision: 03</source><year>2020</year><publisher-name>U.S.&#x000a0;Department of Health and Human Services</publisher-name></element-citation></ref><ref id="bib0007"><label>7</label><element-citation publication-type="book" id="sbref0007"><person-group person-group-type="author"><name><surname>Center for Disease Control and Prevention</surname></name></person-group><chapter-title>Processing of sputum specimens for nucleic acid extraction</chapter-title><source>Technical Report</source><year>2020</year><publisher-name>U.S.&#x000a0;Department of Health and Human Services</publisher-name></element-citation></ref><ref id="bib0008"><label>8</label><mixed-citation publication-type="other" id="othref0001">Operations Research Center, Optimization can solve the ventilator shortage, 2020a, <ext-link ext-link-type="uri" xlink:href="https://www.covidanalytics.io/ventilator_allocation" id="intrrf0002">https://www.covidanalytics.io/ventilator_allocation</ext-link>.</mixed-citation></ref><ref id="bib0009"><label>9</label><element-citation publication-type="book" id="sbref0008"><person-group person-group-type="author"><name><surname>Operations Research Center</surname></name></person-group><chapter-title>Ventilator pooling: formulation and data sources</chapter-title><source>Technical Report</source><year>2020</year><publisher-name>Massachussets Institute of Technology</publisher-name></element-citation><note><p><ext-link ext-link-type="uri" xlink:href="https://www.covidanalytics.io/ventilator_documentation_pdf" id="intrrf0003">https://www.covidanalytics.io/ventilator_documentation_pdf</ext-link></p></note></ref><ref id="bib0010"><label>10</label><element-citation publication-type="journal" id="sbref0009"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>Y.</given-names></name><name><surname>Mockus</surname><given-names>L.</given-names></name><name><surname>Orcun</surname><given-names>S.</given-names></name><name><surname>Reklaitis</surname><given-names>G.</given-names></name></person-group><article-title>Simulation-optimization approach to clinical trial supply chain management with demand scenario forecast</article-title><source>Comput Chem Eng</source><volume>40</volume><year>2012</year><fpage>82</fpage><lpage>96</lpage><pub-id pub-id-type="doi">10.1016/j.compchemeng.2012.01.007</pub-id></element-citation></ref><ref id="bib0011"><label>11</label><mixed-citation publication-type="other" id="othref0002">Presidenza del Consiglio dei Ministri della Repubblica Italian, Misure di potenziamento del servizio sanitario nazionale e di sostegno economico per famiglie, lavoratori e imprese connesse all&#x02019;emergenza epidemiologica da COVID-19, 2020, (Gazzetta Ufficiale della Repubblica Italiana).</mixed-citation></ref><ref id="bib0012"><label>12</label><mixed-citation publication-type="other" id="othref0003">Covid19Italia, Open data coronavirus, 2020, <ext-link ext-link-type="uri" xlink:href="https://www.covid19italia.info/opendata/" id="intrrf0004">https://www.covid19italia.info/opendata/</ext-link>.</mixed-citation></ref><ref id="bib0013"><label>13</label><element-citation publication-type="book" id="sbref0010"><person-group person-group-type="author"><name><surname>European Centre for Disease Prevention and Control</surname></name></person-group><chapter-title>Coronavirus disease 2019 (COVID-19) pandemic: increased transmission in the EU/EEA and the UK</chapter-title><source>Technical Report Seventh update</source><year>2020</year></element-citation></ref><ref id="bib0014"><label>14</label><element-citation publication-type="journal" id="sbref0011"><person-group person-group-type="author"><name><surname>Fleischhacker</surname><given-names>A.</given-names></name><name><surname>Ninh</surname><given-names>A.</given-names></name><name><surname>Zhao</surname><given-names>Y.</given-names></name></person-group><article-title>Positioning inventory in clinical trial supply chains</article-title><source>Prod Oper Manag</source><volume>24</volume><issue>6</issue><year>2015</year><fpage>991</fpage><lpage>1011</lpage><pub-id pub-id-type="doi">10.1111/poms.12302</pub-id></element-citation></ref><ref id="bib0015"><label>15</label><element-citation publication-type="journal" id="sbref0012"><person-group person-group-type="author"><name><surname>France</surname><given-names>G.</given-names></name><name><surname>Taroni</surname><given-names>F.</given-names></name><name><surname>Donatini</surname><given-names>A.</given-names></name></person-group><article-title>The Italian health-care system</article-title><source>Health Econ</source><volume>14</volume><year>2005</year><fpage>S187</fpage><lpage>S202</lpage><pub-id pub-id-type="pmid">16161196</pub-id></element-citation></ref><ref id="bib0016"><label>16</label><element-citation publication-type="journal" id="sbref0013"><person-group person-group-type="author"><name><surname>Freeman</surname><given-names>W.</given-names></name><name><surname>Walker</surname><given-names>S.</given-names></name><name><surname>Vrana</surname><given-names>K.</given-names></name></person-group><article-title>Quantitative RT-PCR: pitfalls and potential</article-title><source>Biotechniques</source><volume>26</volume><issue>1</issue><year>1999</year><fpage>112</fpage><lpage>125</lpage><pub-id pub-id-type="doi">10.2144/99261rv01</pub-id><pub-id pub-id-type="pmid">9894600</pub-id></element-citation></ref><ref id="bib0017"><label>17</label><element-citation publication-type="journal" id="sbref0014"><person-group person-group-type="author"><name><surname>Gunantara</surname><given-names>N.</given-names></name></person-group><article-title>A review of multi-objective optimization: methods and its applications</article-title><source>Cogent Eng</source><volume>5</volume><issue>1</issue><year>2018</year><pub-id pub-id-type="doi">10.1080/23311916.2018.1502242</pub-id></element-citation></ref><ref id="bib0018"><label>18</label><mixed-citation publication-type="other" id="othref0004">Gurobi Optimization LLC, Gurobi optimizer reference manual, 2020, <ext-link ext-link-type="uri" xlink:href="https://www.gurobi.com" id="intrrf0005">https://www.gurobi.com</ext-link>.</mixed-citation></ref><ref id="bib0019"><label>19</label><element-citation publication-type="journal" id="sbref0015"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>H.-C.</given-names></name><name><surname>Araz</surname><given-names>O.</given-names></name><name><surname>Morton</surname><given-names>D.</given-names></name><name><surname>Johnson</surname><given-names>G.</given-names></name><name><surname>Damien</surname><given-names>P.</given-names></name><name><surname>Clements</surname><given-names>B.</given-names></name></person-group><article-title>Stockpiling ventilators for influenza pandemics</article-title><source>Emerg Infect Dis</source><volume>23</volume><issue>6</issue><year>2017</year><fpage>914</fpage><lpage>921</lpage><pub-id pub-id-type="doi">10.3201/eid2306.161417</pub-id><pub-id pub-id-type="pmid">28518041</pub-id></element-citation></ref><ref id="bib0020"><label>20</label><element-citation publication-type="book" id="sbref0016"><person-group person-group-type="author"><name><surname>Kalyanmoy</surname><given-names>D.</given-names></name></person-group><chapter-title>Multi-objective optimization</chapter-title><person-group person-group-type="editor"><name><surname>Burke</surname><given-names>E.</given-names></name><name><surname>Kendall</surname><given-names>G.</given-names></name></person-group><source>Seach methodologies</source><year>2014</year><fpage>403</fpage><lpage>449</lpage><pub-id pub-id-type="doi">10.1007/978-1-4614-6940-7_15</pub-id></element-citation></ref><ref id="bib0021"><label>21</label><element-citation publication-type="book" id="sbref0017"><person-group person-group-type="author"><name><surname>Kaygisiz</surname><given-names>N.B.</given-names></name><name><surname>Shivdasani</surname><given-names>Y.</given-names></name><name><surname>Conti</surname><given-names>R.</given-names></name><name><surname>Berndt</surname><given-names>E.</given-names></name></person-group><chapter-title>The geography of prescription pharmaceuticals supplied to the US: levels, trends and implications</chapter-title><source>Technical Report NBER Working Paper No. 26524</source><year>2019</year><publisher-name>National Bureau of Economic Research</publisher-name><pub-id pub-id-type="doi">10.3386/w26524</pub-id></element-citation></ref><ref id="bib0022"><label>22</label><element-citation publication-type="book" id="sbref0018"><person-group person-group-type="author"><name><surname>Lampariello</surname><given-names>L.</given-names></name><name><surname>Sagratella</surname><given-names>S.</given-names></name></person-group><chapter-title>Effectively managing diagnostic tests to monitor the COVID-19 outbreak in Italy</chapter-title><source>Technical Report</source><year>2020</year><publisher-name>Optimization Online</publisher-name></element-citation></ref><ref id="bib0023"><label>23</label><element-citation publication-type="book" id="sbref0019"><person-group person-group-type="author"><name><surname>Mehrotra</surname><given-names>S.</given-names></name><name><surname>Rahimian</surname><given-names>H.</given-names></name><name><surname>barah</surname><given-names>M.</given-names></name><name><surname>Luo</surname><given-names>F.</given-names></name><name><surname>Karolina</surname><given-names>S.</given-names></name></person-group><chapter-title>A model of supply-chain decisions for resource sharing with an application to ventilator allocation to combat COVID-19</chapter-title><source>Technical Report</source><year>2020</year><publisher-name>Optimization Online</publisher-name></element-citation></ref><ref id="bib0024"><label>24</label><element-citation publication-type="journal" id="sbref0020"><person-group person-group-type="author"><name><surname>Meltzer</surname><given-names>M.</given-names></name><name><surname>Patel</surname><given-names>A.</given-names></name><name><surname>Ajao</surname><given-names>A.</given-names></name><name><surname>Nystrom</surname><given-names>S.</given-names></name><name><surname>Koonin</surname><given-names>L.</given-names></name></person-group><article-title>Estimates of the demand for mechanical ventilation in the united states during an influenza pandemic</article-title><source>Clin Infect Dis</source><volume>60</volume><year>2015</year><fpage>S52</fpage><lpage>S57</lpage><pub-id pub-id-type="doi">10.1093/cid/civ089</pub-id><pub-id pub-id-type="pmid">25878301</pub-id></element-citation></ref><ref id="bib0025"><label>25</label><mixed-citation publication-type="other" id="othref0005">Ministero della Sanit&#x000e0; &#x02014; Direzione Generale della Prevenzione Sanitaria, Pandemia di COVID-19 &#x02014; aggiornamento delle indicazioni sui test diagnostici e sui criteri da adottare nella determinazione delle priorit&#x000e0;. Aggiornamento delle indicazioni relative alla diagnosi di laboratorio, 2020.</mixed-citation></ref><ref id="bib0026"><label>26</label><element-citation publication-type="journal" id="sbref0021"><person-group person-group-type="author"><name><surname>Mirzapour Al-e hashem</surname><given-names>M.</given-names></name><name><surname>Malekly</surname><given-names>H.</given-names></name><name><surname>Aryanezhad</surname><given-names>M.B.</given-names></name></person-group><article-title>A multi-objective robust optimization model for multi-product multi-site aggregate production planning in a supply chain under uncertainty</article-title><source>Int J Prod Econ</source><volume>134</volume><issue>1</issue><year>2011</year><fpage>28</fpage><lpage>42</lpage><pub-id pub-id-type="doi">10.1016/j.ijpe.2011.01.027</pub-id></element-citation></ref><ref id="bib0027"><label>27</label><element-citation publication-type="book" id="sbref0022"><person-group person-group-type="author"><name><surname>Morooka</surname><given-names>I.</given-names></name><name><surname>Keenapan</surname><given-names>N.</given-names></name></person-group><chapter-title>Unicef provides COVID-19 testing reagents to support national pandemic response in Thailand</chapter-title><year>2020</year><publisher-name>UNICEF Press Release</publisher-name></element-citation></ref><ref id="bib0028"><label>28</label><mixed-citation publication-type="other" id="othref0006">OpenToscana, Open data COVID19, 2020, <ext-link ext-link-type="uri" xlink:href="http://dati.toscana.it/dataset/open-data-covid19" id="intrrf0006">http://dati.toscana.it/dataset/open-data-covid19</ext-link>.</mixed-citation></ref><ref id="bib0029"><label>29</label><element-citation publication-type="journal" id="sbref0023"><person-group person-group-type="author"><name><surname>Pan</surname><given-names>X.</given-names></name><name><surname>Chen</surname><given-names>D.</given-names></name><name><surname>Xia</surname><given-names>Y.</given-names></name><name><surname>Wu</surname><given-names>X.</given-names></name><name><surname>Li</surname><given-names>T.</given-names></name><name><surname>Ou</surname><given-names>X.</given-names></name></person-group><article-title>Asymptomatic cases in a family cluster with SARS-CoV-2 infection</article-title><source>Lancet Infect Dis</source><volume>20</volume><issue>4</issue><year>2020</year><fpage>410</fpage><lpage>411</lpage><pub-id pub-id-type="doi">10.1016/S1473-3099(20)30114-6</pub-id><pub-id pub-id-type="pmid">32087116</pub-id></element-citation></ref><ref id="bib0030"><label>30</label><element-citation publication-type="book" id="sbref0024"><person-group person-group-type="author"><name><surname>Pochet</surname><given-names>Y.</given-names></name><name><surname>Wolsey</surname><given-names>L.</given-names></name></person-group><chapter-title>Production planning by mixed integer programming</chapter-title><series>Operations Research and Financial Engineering</series><year>2006</year><publisher-name>Springer</publisher-name><pub-id pub-id-type="doi">10.1007/0-387-33477-7</pub-id></element-citation></ref><ref id="bib0031"><label>31</label><element-citation publication-type="book" id="sbref0025"><person-group person-group-type="author"><name><surname>Preparata</surname><given-names>F.</given-names></name><name><surname>Shamos</surname><given-names>M.I.</given-names></name></person-group><chapter-title>Computational geometry: an introduction</chapter-title><year>2012</year><publisher-name>Springer</publisher-name><pub-id pub-id-type="doi">10.1007/978-1-4612-1098-6</pub-id></element-citation></ref><ref id="bib0032"><label>32</label><mixed-citation publication-type="other" id="othref0007">Presidenza del Consiglio dei Ministri &#x02014; Dipartimento della Protezione Civile, COVID-19 Italia: monitoraggio della situazione, 2020<ext-link ext-link-type="uri" xlink:href="https://github.com/pcm-dpc/COVID-19" id="intrrf0007">https://github.com/pcm-dpc/COVID-19</ext-link>.</mixed-citation></ref><ref id="bib0033"><label>33</label><element-citation publication-type="journal" id="sbref0026"><person-group person-group-type="author"><name><surname>Sanche</surname><given-names>S.</given-names></name><name><surname>Lin</surname><given-names>Y.T.</given-names></name><name><surname>Xu</surname><given-names>C.</given-names></name><name><surname>Romero-Severson</surname><given-names>E.</given-names></name><name><surname>Hengartner</surname><given-names>N.</given-names></name><name><surname>Ke</surname><given-names>R.</given-names></name></person-group><article-title>High contagiousness and rapid spread of severe acute respiratory syndrome coronavirus 2</article-title><source>Emerg infect Dis</source><volume>26</volume><issue>7</issue><year>2020</year><pub-id pub-id-type="doi">10.3201/eid2607.200282</pub-id></element-citation></ref><ref id="bib0034"><label>34</label><mixed-citation publication-type="other" id="othref0008">A. Santini, Increase COVID-19 swab testing capacity via optimisation, 2020a, <ext-link ext-link-type="uri" xlink:href="https://santini.in/covid/" id="intrrf0008">https://santini.in/covid/</ext-link>.</mixed-citation></ref><ref id="bib0035"><label>35</label><element-citation publication-type="book" id="sbref0027"><person-group person-group-type="author"><name><surname>Santini</surname><given-names>A.</given-names></name></person-group><chapter-title>Optimisation tools for the COVID-19 pandemic</chapter-title><year>2020</year><publisher-name>Github repository</publisher-name><pub-id pub-id-type="doi">10.5281/zenodo.3952105</pub-id></element-citation><note><p><ext-link ext-link-type="uri" xlink:href="https://github.com/alberto-santini/covid-optimisation/" id="intrrf0009">https://github.com/alberto-santini/covid-optimisation/</ext-link></p></note></ref><ref id="bib0036"><label>36</label><element-citation publication-type="book" id="sbref0028"><person-group person-group-type="author"><name><surname>Seccia</surname><given-names>R.</given-names></name></person-group><chapter-title>The nurse rostering problem in COVID-19 emergency scenario</chapter-title><source>Technical Report</source><year>2020</year></element-citation></ref><ref id="bib0037"><label>37</label><element-citation publication-type="journal" id="sbref0029"><person-group person-group-type="author"><name><surname>Souf</surname><given-names>S.</given-names></name></person-group><article-title>Recent advances in diagnostic testing for viral infections</article-title><source>Biosci Horiz</source><volume>9</volume><year>2016</year><pub-id pub-id-type="doi">10.1093/biohorizons/hzw010</pub-id></element-citation></ref><ref id="bib0038"><label>38</label><mixed-citation publication-type="other" id="othref0009">Task force COVID-19 del Dipartimento Malattie Infettive e Servizio di Informatica, Istituto Superiore di Sanit&#x000e0;, Epidemia COVID-19, aggiornamento nazionale, 2020, <ext-link ext-link-type="uri" xlink:href="https://www.epicentro.iss.it/coronavirus/bollettino/Bollettino-sorveglianza-integrata-COVID-19_16-aprile-2020.pdf" id="intrrf0010">https://www.epicentro.iss.it/coronavirus/bollettino/Bollettino-sorveglianza-integrata-COVID-19_16-aprile-2020.pdf</ext-link>.</mixed-citation></ref><ref id="bib0039"><label>39</label><element-citation publication-type="journal" id="sbref0030"><person-group person-group-type="author"><name><surname>Tay</surname><given-names>M.Z.</given-names></name><name><surname>Poh</surname><given-names>C.M.</given-names></name><name><surname>R&#x000e9;nia</surname><given-names>L.</given-names></name><name><surname>MacAry</surname><given-names>P.</given-names></name><name><surname>Ng</surname><given-names>L.</given-names></name></person-group><article-title>The trinity of COVID-19: immunity, inflammation and intervention</article-title><source>Nat Rev Immunol</source><year>2020</year><pub-id pub-id-type="doi">10.1038/s41577-020-0311-8</pub-id></element-citation></ref><ref id="bib0040"><label>40</label><element-citation publication-type="journal" id="sbref0031"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>C.</given-names></name><name><surname>Liu</surname><given-names>X.-B.</given-names></name></person-group><article-title>Integrated production planning and control: a multi-objective optimization model</article-title><source>J Ind Eng Manag</source><volume>6</volume><issue>4</issue><year>2013</year><fpage>815</fpage><lpage>830</lpage><pub-id pub-id-type="doi">10.3926/jiem.771</pub-id></element-citation></ref><ref id="bib0041"><label>41</label><element-citation publication-type="journal" id="sbref0032"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y.</given-names></name><name><surname>Wang</surname><given-names>Y.</given-names></name><name><surname>Chen</surname><given-names>Y.</given-names></name><name><surname>Qin</surname><given-names>Q.</given-names></name></person-group><article-title>Unique epidemiological and clinical features of the emerging 2019 novel coronavirus pneumonia (COVID-19) implicate special control measures</article-title><source>J Med Virol</source><volume>92</volume><issue>6</issue><year>2020</year><fpage>568</fpage><lpage>576</lpage><pub-id pub-id-type="doi">10.1002/jmv.25748</pub-id><pub-id pub-id-type="pmid">32134116</pub-id></element-citation></ref><ref id="bib0042"><label>42</label><mixed-citation publication-type="other" id="othref0010">J. Woodcock, Safeguarding pharmaceutical supply chains in a global economy, 2019, <ext-link ext-link-type="uri" xlink:href="https://www.fda.gov/news-events/congressional-testimony/safeguarding-pharmaceutical-supply-chainsglobal-economy-10302019" id="intrrf0011">https://www.fda.gov/news-events/congressional-testimony/safeguarding-pharmaceutical-supply-chainsglobal-economy-10302019</ext-link>.</mixed-citation></ref><ref id="bib0043"><label>43</label><element-citation publication-type="book" id="sbref0033"><person-group person-group-type="author"><name><surname>World Health Organisation</surname></name></person-group><chapter-title>Advice on the use of point-of-care immunodiagnostic tests for COVID-19</chapter-title><source>Technical Report</source><year>2020</year><publisher-name>United Nations</publisher-name></element-citation></ref><ref id="bib0044"><label>44</label><element-citation publication-type="journal" id="sbref0034"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>D.</given-names></name><name><surname>Wu</surname><given-names>T.</given-names></name><name><surname>Liu</surname><given-names>Q.</given-names></name><name><surname>Yang</surname><given-names>Z.</given-names></name></person-group><article-title>The SARS-CoV-2 outbreak: what we know</article-title><source>Int J Infect Dis</source><year>2020</year><pub-id pub-id-type="doi">10.1016/j.ijid.2020.03.004</pub-id></element-citation></ref><ref id="bib0045"><label>45</label><mixed-citation publication-type="other" id="othref0011">F. Wu, A. Wang, M. Liu, Q. Wang, J. Chen, S. Xia, Y. Ling, Y. Zhang, J. Xun, L. Lu, S. Jiang, H. Lu, Y. Wen, J. Huang, Neutralizing antibody responses to SARS-CoV-2 in a COVID-19 recovered patient cohort and their implications, 2020b. doi:<pub-id pub-id-type="doi">10.1101/2020.03.30.20047365</pub-id>.</mixed-citation></ref><ref id="bib0046"><label>46</label><element-citation publication-type="journal" id="sbref0035"><person-group person-group-type="author"><name><surname>Xiang</surname><given-names>Y.</given-names></name><name><surname>Zhuang</surname><given-names>J.</given-names></name></person-group><article-title>A medical resource allocation model for serving emergency victims with deteriorating health conditions</article-title><source>Ann Oper Res</source><volume>236</volume><issue>1</issue><year>2016</year><fpage>177</fpage><lpage>196</lpage><pub-id pub-id-type="doi">10.1007/s10479-014-1716-1</pub-id></element-citation></ref><ref id="bib0047"><label>47</label><element-citation publication-type="journal" id="sbref0036"><person-group person-group-type="author"><name><surname>Zaza</surname><given-names>S.</given-names></name><name><surname>Koonin</surname><given-names>L.</given-names></name><name><surname>Ajao</surname><given-names>A.</given-names></name><name><surname>Nystrom</surname><given-names>S.</given-names></name><name><surname>Branson</surname><given-names>R.</given-names></name><name><surname>Patel</surname><given-names>A.</given-names></name></person-group><article-title>A conceptual framework for allocation of federally stockpiled ventilators during large-scale public health emergencies</article-title><source>Health Secur</source><volume>14</volume><issue>1</issue><year>2016</year><pub-id pub-id-type="doi">10.1089/hs.2015.0043</pub-id></element-citation></ref><ref id="bib0048"><label>48</label><element-citation publication-type="journal" id="sbref0037"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>H.</given-names></name><name><surname>Huang</surname><given-names>E.</given-names></name><name><surname>Dou</surname><given-names>R.</given-names></name><name><surname>Wu</surname><given-names>K.</given-names></name></person-group><article-title>A multi-objective production planning problem with the consideration of time and cost in clinical trials</article-title><source>Expert Syst Appl</source><volume>124</volume><year>2019</year><fpage>25</fpage><lpage>38</lpage><pub-id pub-id-type="doi">10.1016/j.eswa.2019.01.038</pub-id></element-citation></ref></ref-list><sec id="sec0016"><label>Appendix A</label><title>Extended Model formulation</title><p id="p0100">The extended model, which incorporates the considerations made in <xref rid="sec0006" ref-type="sec">Section&#x000a0;5</xref>, uses a new variable <inline-formula><mml:math id="M110" altimg="si87.svg"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> which represents the number of new swabs assigned to lab <italic>l</italic>&#x000a0;&#x02208;&#x000a0;<italic>L</italic> on day <italic>t</italic>&#x000a0;&#x02208;&#x000a0;<italic>T</italic>. The model reads as follows:<disp-formula id="eq0027"><label>(27)</label><mml:math id="M111" altimg="si88.svg"><mml:mrow><mml:mi>min</mml:mi><mml:mspace width="1em"/><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0028"><label>(28)</label><mml:math id="M112" altimg="si89.svg"><mml:mrow><mml:mtext>s.t.</mml:mtext><mml:mspace width="1em"/><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mtext>rg</mml:mtext></mml:msup><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0029"><label>(29)</label><mml:math id="M113" altimg="si90.svg"><mml:mrow><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mtext>sw</mml:mtext></mml:msubsup><mml:mo>&#x02200;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0030"><label>(30)</label><mml:math id="M114" altimg="si91.svg"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02200;</mml:mo><mml:mi>r</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mspace width="0.33em"/><mml:mo>:</mml:mo><mml:mspace width="0.33em"/><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0031"><label>(31)</label><mml:math id="M115" altimg="si92.svg"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mspace width="0.33em"/><mml:mo>:</mml:mo><mml:mspace width="0.33em"/><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0032"><label>(32)</label><mml:math id="M116" altimg="si93.svg"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="1em"/><mml:mo>&#x02200;</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mspace width="0.33em"/><mml:mo>:</mml:mo><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0033"><label>(33)</label><mml:math id="M117" altimg="si94.svg"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0034"><label>(34)</label><mml:math id="M118" altimg="si95.svg"><mml:mrow><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02200;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0035"><label>(35)</label><mml:math id="M119" altimg="si96.svg"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>r</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0036"><label>(36)</label><mml:math id="M120" altimg="si97.svg"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0037"><label>(37)</label><mml:math id="M121" altimg="si98.svg"><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02200;</mml:mo><mml:mi>r</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0038"><label>(38)</label><mml:math id="M122" altimg="si99.svg"><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>r</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0039"><label>(39)</label><mml:math id="M123" altimg="si100.svg"><mml:mrow><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02192;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo linebreak="goodbreak">&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0040"><label>(40)</label><mml:math id="M124" altimg="si101.svg"><mml:mrow><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02192;</mml:mo><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02265;</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0041"><label>(41)</label><mml:math id="M125" altimg="si102.svg"><mml:mrow><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02192;</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>&#x02228;</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0042"><label>(42)</label><mml:math id="M126" altimg="si103.svg"><mml:mrow><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02192;</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0043"><label>(43)</label><mml:math id="M127" altimg="si104.svg"><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.33em"/><mml:mo>&#x02192;</mml:mo><mml:mspace width="0.33em"/><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02265;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.16em"/><mml:mspace width="0.16em"/><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.33em"/><mml:mo>&#x02192;</mml:mo><mml:mspace width="0.33em"/><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0044"><label>(44)</label><mml:math id="M128" altimg="si105.svg"><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>&#x02212;</mml:mo></mml:msubsup><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02192;</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02265;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>&#x02212;</mml:mo></mml:msubsup><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02192;</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0045"><label>(45)</label><mml:math id="M129" altimg="si106.svg"><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo linebreak="goodbreak">+</mml:mo><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>&#x02212;</mml:mo></mml:msubsup><mml:mo>&#x02264;</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0046"><label>(46)</label><mml:math id="M130" altimg="si107.svg"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mo>&#x02228;</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi>R</mml:mi><mml:mspace width="0.28em"/><mml:mo>:</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0047"><label>(47)</label><mml:math id="M131" altimg="si108.svg"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">&#x0003c;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mspace width="4.pt"/><mml:mtext>and</mml:mtext><mml:mspace width="4.pt"/><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">&#x0003c;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mo>&#x02228;</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>l</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>l</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mspace width="0.28em"/><mml:mo>:</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0048"><label>(48)</label><mml:math id="M132" altimg="si109.svg"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">&#x0003c;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:msub><mml:mspace width="4.pt"/><mml:mtext>and</mml:mtext><mml:mspace width="4.pt"/><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">&#x0003c;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mo>&#x02228;</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>l</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>l</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mspace width="0.28em"/><mml:mo>:</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0049"><label>(49)</label><mml:math id="M133" altimg="si110.svg"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">&#x0003c;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:msub><mml:mspace width="4.pt"/><mml:mtext>and</mml:mtext><mml:mspace width="4.pt"/><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">&#x0003c;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>&#x02200;</mml:mo><mml:mi>r</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mspace width="0.33em"/><mml:mo>:</mml:mo><mml:mspace width="0.33em"/><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0050"><label>(50)</label><mml:math id="M134" altimg="si111.svg"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>&#x02200;</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mspace width="0.33em"/><mml:mo>:</mml:mo><mml:mspace width="0.33em"/><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0051"><label>(51)</label><mml:math id="M135" altimg="si112.svg"><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>&#x02200;</mml:mo><mml:mi>r</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0052"><label>(52)</label><mml:math id="M136" altimg="si113.svg"><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="eq0053"><label>(53)</label><mml:math id="M137" altimg="si114.svg"><mml:mrow><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>&#x02212;</mml:mo></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:mo>&#x02200;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:mo>&#x02200;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula>
</p><p id="p0101">Without loss of generality, one can linearise indicator constraints of the type <inline-formula><mml:math id="M138" altimg="si115.svg"><mml:mrow><mml:mi>y</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02192;</mml:mo><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> for a binary variable <italic>y</italic> and a non-negative integer variable <italic>x</italic>, introducing a non-negative slack variable <italic>s</italic> and transforming inequality <italic>ax</italic>&#x000a0;&#x02264;&#x000a0;<italic>b</italic> into <inline-formula><mml:math id="M139" altimg="si116.svg"><mml:mrow><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo linebreak="goodbreak">+</mml:mo><mml:mi>s</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula>. Then the &#x0201c;big-<italic>M</italic>&#x0201d; inequality <italic>s</italic>&#x000a0;&#x02264;&#x000a0;<italic>My</italic> enforces the indicator constraint.</p><p id="p0102">Similarly, one can linearise constraints of type <inline-formula><mml:math id="M140" altimg="si117.svg"><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>&#x02228;</mml:mo><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> where both <italic>x</italic> and <italic>y</italic> are integer an non-negative. Consider two binary variables <italic>s<sub>x</sub>, s<sub>y</sub></italic> which will take value 1 if, respectively, <italic>x</italic> and <italic>y</italic> are strictly positive. Then the following three inequalities linearise the original constraint: <inline-formula><mml:math id="M141" altimg="si118.svg"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>M</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.16em"/><mml:mi>y</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>M</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.28em"/><mml:msub><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p></sec><ack id="ack0001"><title>Acknowledgements</title><p>The author would like to thank Michele Iacono of Roche Diagnostics S.p.A. and Xavier Jim&#x000e9;nez F&#x000e0;brega of the Health Department of Catalonia for comments and fruitful discussions on this work. The author would also like to thank two anonymous reviewers for suggesting important improvements to this paper.</p></ack><fn-group><fn id="d33e2990"><label>&#x02606;</label><p id="np0001">This manuscript was processed by Associate Editor Thomas Sharkey.</p></fn></fn-group></back></article>