<?xml version="1.0" encoding="UTF-8"?>
<p>Raw sequencing reads were first processed with Kraken (
 <xref rid="B15" ref-type="bibr">15</xref>) to identify human and bacterial reads. Kraken was run with default parameters (k = 31 with no filtering), using a custom database containing the human genome together with all bacterial, archaeal and viral genomes from RefSeq, a subset of fungal genomes, and all 9,049 complete HIV genomes from GenBank (last updated 18 May 2018). Reads were filtered to retain only viral and unclassified sequences, and these were trimmed to remove adaptors and low-quality bases using Trimmomatic (
 <xref rid="B16" ref-type="bibr">16</xref>), retaining reads of at least 80 bp. Filtered, trimmed sequences were assembled into contigs using SPAdes (
 <xref rid="B17" ref-type="bibr">17</xref>) and metaSPAdes (
 <xref rid="B18" ref-type="bibr">18</xref>) with default parameters for k (21 to 127). Contiguous sequences assembled from both assembly runs were clustered using cd-hit-est to remove redundant contigs (
 <xref rid="B19" ref-type="bibr">19</xref>), retaining the longest sequence in each cluster with a minimum sequence identity threshold of 0.9. Contigs, together with the filtered reads, were then used to generate HIV genomes and variant frequencies using 
 <italic>shiver</italic> (
 <xref rid="B20" ref-type="bibr">20</xref>), with position-based deduplication of reads enabled. Samples for which no contigs could be assembled were mapped to the closest known HIV reference as identified by Kallisto (
 <xref rid="B21" ref-type="bibr">21</xref>), hashing the filtered reads against a set of 199 HIV reference genomes from the Los Alamos HIV database (
 <ext-link ext-link-type="uri" xlink:href="http://www.hiv.lanl.gov/" xmlns:xlink="http://www.w3.org/1999/xlink">http://www.hiv.lanl.gov/</ext-link>), and taking the closest matching genome as the mapping reference for 
 <italic>shiver</italic>. veSEQ-HIV is quantitative, in that the total amount of sequences recovered correlated with viral load. This arises because PCR conditions remain nonsaturating and unbiased probes are used for virus enrichment. A further slight improvement is obtained by computationally removing duplicate copies of viral fragments from sequence data, which are generated by non-virus-specific PCR steps in the protocol. The sequence-derived viral load, in copies/ml, was calculated from the number of deduplicated HIV reads for each sample, using a linear regression model derived from a subset of 146 samples for which we obtained an independent, clinically measured viral load. The 
 <italic>R</italic>
 <sup>2</sup> value for this model was 0.89, with no evidence of bias and a mean squared error of prediction of 0.324 log
 <sub>10</sub> copies/ml. The model was used to estimate a sequence-derived viral load for the full data set.
</p>
