<?xml version="1.0" encoding="UTF-8"?>
<p id="Par33">We performed the gene set enrichment analysis as an additional prioritization method. We first collected three differential gene expression data sets of hosts infected by HCoVs from the NCBI Gene Expression Omnibus (GEO). Among them, two transcriptome data sets were SARS-CoV-infected samples from patient’s peripheral blood
 <sup>
  <xref ref-type="bibr" rid="CR94">94</xref>
 </sup> (GSE1739) and Calu-3 cells
 <sup>
  <xref ref-type="bibr" rid="CR95">95</xref>
 </sup> (GSE33267), respectively. One transcriptome data set was MERS-CoV-infected Calu-3 cells
 <sup>
  <xref ref-type="bibr" rid="CR96">96</xref>
 </sup> (GSE122876). Adjusted 
 <italic>P</italic> value less than 0.01 was defined as differentially expressed genes. These data sets were used as HCoV–host signatures to evaluate the treatment effects of drugs. Differential gene expression in cells treated with various drugs were retrieved from the Connectivity Map (CMAP) database
 <sup>
  <xref ref-type="bibr" rid="CR36">36</xref>
 </sup>, and were used as gene profiles for the drugs. For each drug that was in both the CMAP data set and our drug–target network, we calculated an enrichment score (ES) for each HCoV signature data set based on previously described methods
 <sup>
  <xref ref-type="bibr" rid="CR97">97</xref>
 </sup> as follows:
 <disp-formula id="Equ4">
  <label>4</label>
  <alternatives>
   <tex-math id="M11">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\mathrm {ES}} = \left\{ {\begin{array}{*{20}{c}} {{\mathrm{ES}_{\mathrm{up}}} - {\mathrm {ES}_{\mathrm{down}}},{\mathrm {sgn}}\left( {{\mathrm {ES}_{\mathrm{up}}}} \right)\, \ne \,{\mathrm {sgn}}\left( {{\mathrm {ES}_{\mathrm{down}}}} \right)} \\ {0,\mathrm {else}} \end{array}} \right.$$\end{document}</tex-math>
   <math id="M12">
    <mrow>
     <mi mathvariant="normal">ES</mi>
     <mo>=</mo>
     <mfenced close="" open="{" separators="">
      <mrow>
       <mtable>
        <mtr>
         <mtd columnalign="center">
          <msub>
           <mrow>
            <mi mathvariant="normal">ES</mi>
           </mrow>
           <mrow>
            <mi mathvariant="normal">up</mi>
           </mrow>
          </msub>
          <mo>−</mo>
          <msub>
           <mrow>
            <mi mathvariant="normal">ES</mi>
           </mrow>
           <mrow>
            <mi mathvariant="normal">down</mi>
           </mrow>
          </msub>
          <mo>,</mo>
          <mi mathvariant="normal">sgn</mi>
          <mfenced close=")" open="(" separators="">
           <mrow>
            <msub>
             <mrow>
              <mi mathvariant="normal">ES</mi>
             </mrow>
             <mrow>
              <mi mathvariant="normal">up</mi>
             </mrow>
            </msub>
           </mrow>
          </mfenced>
          <mspace width="0.25em"/>
          <mo>≠</mo>
          <mspace width="0.25em"/>
          <mi mathvariant="normal">sgn</mi>
          <mfenced close=")" open="(" separators="">
           <mrow>
            <msub>
             <mrow>
              <mi mathvariant="normal">ES</mi>
             </mrow>
             <mrow>
              <mi mathvariant="normal">down</mi>
             </mrow>
            </msub>
           </mrow>
          </mfenced>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mn>0</mn>
          <mo>,</mo>
          <mi mathvariant="normal">else</mi>
         </mtd>
        </mtr>
       </mtable>
      </mrow>
     </mfenced>
    </mrow>
   </math>
   <graphic xlink:href="41421_2020_153_Article_Equ4.gif" position="anchor" xmlns:xlink="http://www.w3.org/1999/xlink"/>
  </alternatives>
 </disp-formula>ES
 <sub>up</sub> and ES
 <sub>down</sub> were calculated separately for the up- and down-regulated genes from the HCoV signature data set using the same method. We first computed 
 <italic>a</italic>
 <sub>up/down</sub> and 
 <italic>b</italic>
 <sub>up/down</sub> as
 <disp-formula id="Equ5">
  <label>5</label>
  <alternatives>
   <tex-math id="M13">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$a = \mathop{\max}\limits_{1 \le j \le s}\left( {\frac{j}{s} - \frac{{V\left( j \right)}}{r}} \right),$$\end{document}</tex-math>
   <math id="M14">
    <mrow>
     <mi>a</mi>
     <mo>=</mo>
     <munder>
      <mrow>
       <mi>max</mi>
      </mrow>
      <mrow>
       <mn>1</mn>
       <mo>≤</mo>
       <mi>j</mi>
       <mo>≤</mo>
       <mi>s</mi>
      </mrow>
     </munder>
     <mfenced close=")" open="(" separators="">
      <mrow>
       <mfrac>
        <mrow>
         <mi>j</mi>
        </mrow>
        <mrow>
         <mi>s</mi>
        </mrow>
       </mfrac>
       <mo>−</mo>
       <mfrac>
        <mrow>
         <mi>V</mi>
         <mfenced close=")" open="(" separators="">
          <mrow>
           <mi>j</mi>
          </mrow>
         </mfenced>
        </mrow>
        <mrow>
         <mi>r</mi>
        </mrow>
       </mfrac>
      </mrow>
     </mfenced>
     <mo>,</mo>
    </mrow>
   </math>
   <graphic xlink:href="41421_2020_153_Article_Equ5.gif" position="anchor" xmlns:xlink="http://www.w3.org/1999/xlink"/>
  </alternatives>
 </disp-formula>
 <disp-formula id="Equ6">
  <label>6</label>
  <alternatives>
   <tex-math id="M15">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$b = \mathop{\max}\limits_{1 \le j \le s}\left( {\frac{{V\left( j \right)}}{r} - \frac{{j - 1}}{s}} \right),$$\end{document}</tex-math>
   <math id="M16">
    <mrow>
     <mi>b</mi>
     <mo>=</mo>
     <munder>
      <mrow>
       <mi>max</mi>
      </mrow>
      <mrow>
       <mn>1</mn>
       <mo>≤</mo>
       <mi>j</mi>
       <mo>≤</mo>
       <mi>s</mi>
      </mrow>
     </munder>
     <mfenced close=")" open="(" separators="">
      <mrow>
       <mfrac>
        <mrow>
         <mi>V</mi>
         <mfenced close=")" open="(" separators="">
          <mrow>
           <mi>j</mi>
          </mrow>
         </mfenced>
        </mrow>
        <mrow>
         <mi>r</mi>
        </mrow>
       </mfrac>
       <mo>−</mo>
       <mfrac>
        <mrow>
         <mi>j</mi>
         <mo>−</mo>
         <mn>1</mn>
        </mrow>
        <mrow>
         <mi>s</mi>
        </mrow>
       </mfrac>
      </mrow>
     </mfenced>
     <mo>,</mo>
    </mrow>
   </math>
   <graphic xlink:href="41421_2020_153_Article_Equ6.gif" position="anchor" xmlns:xlink="http://www.w3.org/1999/xlink"/>
  </alternatives>
 </disp-formula>where 
 <italic>j</italic> = 1, 2, …, 
 <italic>s</italic> were the genes of HCoV signature data set sorted in ascending order by their rank in the gene profiles of the drug being evaluated. The rank of gene 
 <italic>j</italic> is denoted by 
 <italic>V</italic>(
 <italic>j</italic>), where 1 ≤ 
 <italic>V</italic>(
 <italic>j</italic>) ≤ 
 <italic>r</italic>, with 
 <italic>r</italic> being the number of genes (12,849) from the drug profile. Then, ES
 <sub>up/down</sub> was set to 
 <italic>a</italic>
 <sub>up/down</sub> if 
 <italic>a</italic>
 <sub>up/down</sub> &gt; 
 <italic>b</italic>
 <sub>up/down</sub>, and was set to −
 <italic>b</italic>
 <sub>up/down</sub> if 
 <italic>b</italic>
 <sub>up/down</sub> &gt; 
 <italic>a</italic>
 <sub>up/down</sub>. Permutation tests repeated 100 times using randomly generated gene lists with the same number of up- and down-regulated genes as the HCoV signature data set were performed to measure the significance of the ES scores. Drugs were considered to have potential treatment effect if ES &gt; 0 and 
 <italic>P</italic> &lt; 0.05, and the number of such HCoV signature data sets were used as the final GSEA score that ranges from 0 to 3.
</p>
